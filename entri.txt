Lanjut di chat baru karena chat lama sudah limit.
kita sedang membangun sistem ya bro, berikut detail nya

ðŸ“„ Rancangan Sistem Manajemen Stok Gudang
1. Gambaran Umum
Sistem ini dirancang untuk mendukung manajemen stok gudang yang dapat menampung beberapa perusahaan. Sistem ini mencatat stok keluar-masuk, dan juga memastikan setiap proses memiliki status & approval yang jelas. Hal ini penting untuk tracking, akurasi stok, dan transparansi, dengan fitur yang lengkap mulai dari penerimaan barang, pemindahan antar gudang, hingga proses retur. Sistem ini tidak mencatat harga, sebab hanya berfokus pada barang dan jumlah item nya saja.
Aplikasi akan dikembangkan menggunakan CodeIgniter 3.1.13 dengan tampilan berbasis SB Admin 2 (Bootstrap 4), serta database MySQL.

2. Fitur Utama
2.1 Multi Perusahaan
    a. Sistem mendukung banyak perusahaan sekaligus.
    b. Data dipisahkan berdasarkan perusahaan (barang, gudang, pelanggan, supplier, stok).

2.2 Manajemen Hak Akses (Role-Based Access)
Hak akses diatur berdasarkan role:
    1. Super Admin â†’ mengelola semua perusahaan.
    2. Admin Perusahaan â†’ mengelola seluruh data dan transaksi dalam lingkup perusahaannya.
    3. Sales Online â†’ melakukan input penjualan ke konsumen, tidak menyimpan stok.
    4. Admin Packing â†’ menangani proses packing, pengiriman, dan konfirmasi barang sampai.
    5. Admin Return â†’ memproses verifikasi dan approval retur barang.

3. Menu Aktifitas
3.1 Pemindahan Barang
Pemindahan barang bisa berupa:
    1. Gudang â†’ Gudang lain (internal transfer).
    2. Gudang â†’ Pelanggan (distributor resmi).
    3. Gudang â†’ Konsumen (melalui penjualan oleh Sales).
Catatan: Sales tidak memiliki stok. Barang tetap diambil dari gudang.

Alur Status Pemindahan:
    a. Draft â†’ transaksi baru dibuat.
    b. Packing â†’ barang sedang diproses untuk dikemas.
    c. Shipping â†’ barang dalam proses pengiriman, stok gudang sudah dikurangi.
    d. Delivered â†’ barang diterima tujuan, transaksi selesai.
    e. Cancelled â†’ pemindahan dibatalkan (stok dikembalikan jika sudah dikurangi).

3.2 Penerimaan Barang
    a. Input nomor penerimaan (berdasarkan supplier).
    b. Input detail barang yang masuk ke gudang.

Alur Status Penerimaan:
    a. Draft â†’ data penerimaan dibuat.
    b. Received â†’ barang sudah dicatat masuk, stok gudang bertambah.
    c. Completed â†’ penerimaan selesai diproses.
    d. Cancelled â†’ penerimaan dibatalkan.

3.3 Retur Barang Penjualan
Yaitu retur barang dari pelanggan/konsumen.
Alur Status Retur:
    a.Requested â†’ retur diajukan.
    b.Verification â†’ barang diperiksa oleh Admin Return.
    c.Approved â†’ retur diterima, stok gudang bertambah
    d. Rejected â†’ retur ditolak, tidak ada perubahan stok.
    e.Completed â†’ retur selesai diproses.

3.4 Retur Barang Pembelian
Yaitu retur barang ke supplier.
Alur Status Retur:
    a.Requested â†’ retur diajukan.
    b.Verification â†’ barang diperiksa oleh Admin Return.
    c.Approved â†’ retur diterima, stok gudang bertambah (untuk retur penjualan) atau berkurang (untuk retur pembelian).
    d. Rejected â†’ retur ditolak, tidak ada perubahan stok.
    e.Completed â†’ retur selesai diproses.

4. Menu Setup
    1. Perusahaan â†’ master data Perusahaa.
    2. Kategori â†’ master data kategori barang (per perusahaan).
    3. Barang â†’ master data barang (relasi ke perusahaan & kategori).
    4. Gudang â†’ daftar gudang per perusahaan.
    5. Sales â†’ user dengan role Sales Online Per perusahaan.
    6. Admin Packing â†’ user dengan role Admin Packing per perusahaan.
    7. Pelanggan â†’ distributor resmi per perusahaan.
    8. Supplier â†’ pemasok per perusahaan.

5. Menu Laporan
    1. Laporan Sales â†’ detail penjualan ke konsumen/pelanggan (per perusahaan per gudang)
    2. Laporan Packing â†’ aktivitas pengiriman & pekerjaan Admin Packing (per perusahaan per gudang)
    3. Laporan Mutasi â†’ pergerakan barang antar gudang & transaksi keluar/masuk (per perusahaan per gudang)
    4. Laporan Summary â†’ ringkasan stok masuk, keluar, dan saldo akhir (per perusahaan per gudang)


untuk menu sendiri akan dibuat dengan posisi top_menu dan susunannya seperti ini
â”œDashboard
â”œSetup
â”‚ â”œPerusahaan
â”‚ â”œKategori Barang
â”‚ â”œBarang
â”‚ â”œGudang
â”‚ â”œPelanggan
â”‚ â””Supplier
â”‚ â”œSales
â”‚ â”œAdmin Packing
â”œAktifitas
â”‚ â”œPemindahan Barang
â”‚ â”œPenerimaan Barang
â”‚ â”œRetur Penjualan
â”‚ â””Retur Pembelian
â”œDaftar
â”‚ â”œPemindahan Barang
â”‚ â”œPenerimaan Barang
â”‚ â”œRetur Penjualan
â”‚ â””Retur Pembelian
â”œLaporan
â”‚ â”œSales
â”‚ â”œPacking
â”‚ â”œMutasi Barang
â”‚ â””Ringkasan Stok


database yang digunakan yaitu
-- Database: gudang_system

-- Tabel perusahaan (tidak memiliki dependensi)
CREATE TABLE `perusahaan` (
  `id_perusahaan` int(11) NOT NULL,
  `nama_perusahaan` varchar(255) NOT NULL,
  `alamat` varchar(255) DEFAULT NULL,
  `telepon` varchar(20) DEFAULT NULL,
  `email` varchar(100) DEFAULT NULL,
  `status_aktif` tinyint(1) DEFAULT 1,
  `deleted_at` datetime DEFAULT NULL,
  `created_at` datetime DEFAULT current_timestamp(),
  `updated_at` datetime DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel role_user (tidak memiliki dependensi)
CREATE TABLE `role_user` (
  `id_role` int(11) NOT NULL,
  `nama_role` varchar(50) NOT NULL,
  `deskripsi` text DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel pengaturan_sistem (tidak memiliki dependensi)
CREATE TABLE `pengaturan_sistem` (
  `id_pengaturan` int(11) NOT NULL,
  `key` varchar(50) NOT NULL,
  `value` text DEFAULT NULL,
  `keterangan` text DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel menu (tidak memiliki dependensi)
CREATE TABLE `menu` (
  `id_menu` int(11) NOT NULL,
  `nama_menu` varchar(50) NOT NULL,
  `url` varchar(100) DEFAULT NULL,
  `permission` varchar(50) DEFAULT NULL,
  `icon` varchar(50) DEFAULT NULL,
  `deskripsi` text DEFAULT NULL,
  `urutan` int(11) DEFAULT 0,
  `id_parent` int(11) DEFAULT NULL,
  `status_aktif` tinyint(1) DEFAULT 1,
  `tipe` enum('menu','submenu') NOT NULL DEFAULT 'menu'
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel user (bergantung pada role_user dan perusahaan)
CREATE TABLE `user` (
  `id_user` int(11) NOT NULL,
  `nama` varchar(100) NOT NULL,
  `username` varchar(50) NOT NULL,
  `password_hash` varchar(255) NOT NULL,
  `id_role` int(11) NOT NULL,
  `id_perusahaan` int(11) DEFAULT NULL,
  `email` varchar(100) DEFAULT NULL,
  `telepon` varchar(20) DEFAULT NULL,
  `created_by` int(11) DEFAULT NULL,
  `aktif` tinyint(1) DEFAULT 1,
  `created_at` datetime DEFAULT current_timestamp(),
  `updated_at` datetime DEFAULT NULL,
  `last_login` datetime DEFAULT NULL,
  `foto_profil` varchar(255) DEFAULT NULL,
  `remember_token` varchar(100) DEFAULT NULL,
  `token_expires` datetime DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel kategori (bergantung pada perusahaan)
CREATE TABLE `kategori` (
  `id_kategori` int(11) NOT NULL,
  `id_perusahaan` int(11) NOT NULL,
  `nama_kategori` varchar(50) NOT NULL,
  `deskripsi` text DEFAULT NULL,
  `status_aktif` tinyint(1) DEFAULT 1,
  `deleted_at` datetime DEFAULT NULL,
  `created_at` datetime DEFAULT current_timestamp(),
  `updated_at` datetime DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel gudang (bergantung pada perusahaan dan user)
CREATE TABLE `gudang` (
  `id_gudang` int(11) NOT NULL,
  `id_perusahaan` int(11) NOT NULL,
  `nama_gudang` varchar(100) NOT NULL,
  `alamat` text DEFAULT NULL,
  `telepon` varchar(20) DEFAULT NULL,
  `created_by` int(11) DEFAULT NULL,
  `status_aktif` tinyint(1) DEFAULT 1,
  `deleted_at` datetime DEFAULT NULL,
  `created_at` datetime DEFAULT current_timestamp(),
  `updated_at` datetime DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel pelanggan (bergantung pada perusahaan)
CREATE TABLE `pelanggan` (
  `id_pelanggan` int(11) NOT NULL,
  `id_perusahaan` int(11) NOT NULL,
  `nama_pelanggan` varchar(100) NOT NULL,
  `alamat` text DEFAULT NULL,
  `telepon` varchar(20) DEFAULT NULL,
  `email` varchar(100) DEFAULT NULL,
  `tipe_pelanggan` enum('distributor','konsumen') DEFAULT 'konsumen',
  `status_aktif` tinyint(1) DEFAULT 1,
  `deleted_at` datetime DEFAULT NULL,
  `created_at` datetime DEFAULT current_timestamp(),
  `updated_at` datetime DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel supplier (bergantung pada perusahaan)
CREATE TABLE `supplier` (
  `id_supplier` int(11) NOT NULL,
  `id_perusahaan` int(11) NOT NULL,
  `nama_supplier` varchar(100) NOT NULL,
  `alamat` text DEFAULT NULL,
  `telepon` varchar(20) DEFAULT NULL,
  `email` varchar(100) DEFAULT NULL,
  `kontak_person` varchar(100) DEFAULT NULL,
  `status_aktif` tinyint(1) DEFAULT 1,
  `deleted_at` datetime DEFAULT NULL,
  `created_at` datetime DEFAULT current_timestamp(),
  `updated_at` datetime DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel barang (bergantung pada kategori dan perusahaan)
CREATE TABLE `barang` (
  `id_barang` int(11) NOT NULL,
  `id_perusahaan` int(11) NOT NULL,
  `id_kategori` int(11) DEFAULT NULL,
  `nama_barang` varchar(100) NOT NULL,
  `gambar` varchar(255) DEFAULT NULL,
  `sku` varchar(50) NOT NULL,
  `deskripsi` text DEFAULT NULL,
  `satuan` varchar(20) DEFAULT NULL,
  `status_aktif` tinyint(1) DEFAULT 1,
  `deleted_at` datetime DEFAULT NULL,
  `created_at` datetime DEFAULT current_timestamp(),
  `updated_at` datetime DEFAULT current_timestamp() ON UPDATE current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel stok_gudang (bergantung pada perusahaan, gudang, dan barang)
CREATE TABLE `stok_gudang` (
  `id_stok` int(11) NOT NULL,
  `id_perusahaan` int(11) NOT NULL,
  `id_gudang` int(11) NOT NULL,
  `id_barang` int(11) NOT NULL,
  `jumlah` int(11) NOT NULL DEFAULT 0,
  `reserved` int(11) NOT NULL DEFAULT 0 COMMENT 'Jumlah stok yang dipesan tapi belum dikirim',
  `created_at` datetime DEFAULT current_timestamp(),
  `updated_at` datetime DEFAULT current_timestamp() ON UPDATE current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel stok_awal (bergantung pada barang, gudang, perusahaan, dan user)
CREATE TABLE `stok_awal` (
  `id_stok_awal` int(11) NOT NULL,
  `id_barang` int(11) NOT NULL,
  `id_gudang` int(11) NOT NULL,
  `id_perusahaan` int(11) NOT NULL,
  `qty_awal` int(11) NOT NULL,
  `keterangan` text DEFAULT NULL,
  `created_at` datetime DEFAULT current_timestamp(),
  `created_by` int(11) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel approval_flow (bergantung pada role_user)
CREATE TABLE `approval_flow` (
  `id_approval` int(11) NOT NULL,
  `tipe_transaksi` enum('penjualan','pembelian','penerimaan','retur_penjualan','retur_pembelian','transfer_stok') NOT NULL,
  `status_dari` varchar(20) NOT NULL,
  `status_ke` varchar(20) NOT NULL,
  `id_role` int(11) NOT NULL,
  `urutan` int(11) NOT NULL,
  `status_aktif` tinyint(1) DEFAULT 1
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel hak_akses_menu (bergantung pada role_user dan menu)
CREATE TABLE `hak_akses_menu` (
  `id_hak_akses` int(11) NOT NULL,
  `id_role` int(11) NOT NULL,
  `id_menu` int(11) NOT NULL,
  `can_view` tinyint(1) NOT NULL DEFAULT 0,
  `can_create` tinyint(1) NOT NULL DEFAULT 0,
  `can_edit` tinyint(1) NOT NULL DEFAULT 0,
  `can_delete` tinyint(1) NOT NULL DEFAULT 0
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel penjualan (bergantung pada perusahaan, user, dan pelanggan)
CREATE TABLE `penjualan` (
  `id_penjualan` int(11) NOT NULL,
  `id_perusahaan` int(11) NOT NULL,
  `no_invoice` varchar(50) DEFAULT NULL,
  `id_user` int(11) NOT NULL,
  `id_pelanggan` int(11) DEFAULT NULL,
  `tanggal_penjualan` datetime NOT NULL,
  `keterangan` text DEFAULT NULL,
  `status` enum('Draft','Packing','Shipping','Delivered','Cancelled') DEFAULT 'Draft',
  `deleted_at` datetime DEFAULT NULL,
  `created_at` datetime DEFAULT current_timestamp(),
  `updated_at` datetime DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel pembelian (bergantung pada perusahaan, user, dan supplier)
CREATE TABLE `pembelian` (
  `id_pembelian` int(11) NOT NULL,
  `id_perusahaan` int(11) NOT NULL,
  `no_pembelian` varchar(50) DEFAULT NULL,
  `id_user` int(11) NOT NULL,
  `id_supplier` int(11) DEFAULT NULL,
  `tanggal_pembelian` datetime NOT NULL,
  `tanggal_estimasi` datetime DEFAULT NULL,
  `keterangan` text DEFAULT NULL,
  `status` enum('Draft','Received','Completed','Cancelled') DEFAULT 'Draft',
  `deleted_at` datetime DEFAULT NULL,
  `created_at` datetime DEFAULT current_timestamp(),
  `updated_at` datetime DEFAULT current_timestamp() ON UPDATE current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel penerimaan_barang (bergantung pada pembelian, user, dan gudang)
CREATE TABLE `penerimaan_barang` (
  `id_penerimaan` int(11) NOT NULL,
  `no_penerimaan` varchar(50) DEFAULT NULL,
  `id_pembelian` int(11) DEFAULT NULL,
  `id_user` int(11) NOT NULL,
  `id_gudang` int(11) NOT NULL,
  `tanggal_penerimaan` datetime NOT NULL,
  `keterangan` text DEFAULT NULL,
  `status` enum('Draft','Received','Completed','Cancelled') DEFAULT 'Draft',
  `created_at` datetime DEFAULT current_timestamp(),
  `updated_at` datetime DEFAULT current_timestamp() ON UPDATE current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel transfer_stok (bergantung pada perusahaan, gudang, dan user)
CREATE TABLE `transfer_stok` (
  `id_transfer` int(11) NOT NULL,
  `no_transfer` varchar(50) DEFAULT NULL,
  `id_perusahaan` int(11) NOT NULL,
  `id_gudang_asal` int(11) NOT NULL,
  `id_gudang_tujuan` int(11) NOT NULL,
  `id_user` int(11) NOT NULL,
  `tanggal` datetime NOT NULL,
  `keterangan` varchar(255) DEFAULT NULL,
  `status` enum('Draft','Packing','Shipping','Delivered','Cancelled') DEFAULT 'Draft',
  `created_at` datetime DEFAULT current_timestamp(),
  `updated_at` datetime DEFAULT current_timestamp() ON UPDATE current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel packing (bergantung pada user)
CREATE TABLE `packing` (
  `id_packing` int(11) NOT NULL,
  `id_referensi` int(11) NOT NULL COMMENT 'ID dari transaksi terkait (penjualan/transfer)',
  `tipe_referensi` enum('penjualan','transfer') NOT NULL,
  `id_user` int(11) NOT NULL,
  `tanggal_packing` datetime NOT NULL,
  `status` enum('Draft','Packing','Completed','Cancelled') DEFAULT 'Draft',
  `catatan` text DEFAULT NULL,
  `created_at` datetime DEFAULT current_timestamp(),
  `updated_at` datetime DEFAULT current_timestamp() ON UPDATE current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel retur_penjualan (bergantung pada penjualan dan user)
CREATE TABLE `retur_penjualan` (
  `id_retur` int(11) NOT NULL,
  `no_retur` varchar(50) DEFAULT NULL,
  `id_penjualan` int(11) NOT NULL,
  `id_user` int(11) NOT NULL,
  `tanggal_retur` datetime NOT NULL,
  `alasan_retur` text NOT NULL,
  `status` enum('Requested','Verification','Approved','Rejected','Completed') DEFAULT 'Requested',
  `created_at` datetime DEFAULT current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel retur_pembelian (bergantung pada pembelian, user, dan supplier)
CREATE TABLE `retur_pembelian` (
  `id_retur_beli` int(11) NOT NULL,
  `no_retur_beli` varchar(50) DEFAULT NULL,
  `id_pembelian` int(11) DEFAULT NULL,
  `id_user` int(11) NOT NULL,
  `id_supplier` int(11) NOT NULL,
  `tanggal_retur` datetime NOT NULL,
  `alasan_retur` text NOT NULL,
  `status` enum('Requested','Verification','Approved','Rejected','Completed') DEFAULT 'Requested',
  `created_at` datetime DEFAULT current_timestamp(),
  `updated_at` datetime DEFAULT current_timestamp() ON UPDATE current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel detail_penjualan (bergantung pada penjualan, barang, dan gudang)
CREATE TABLE `detail_penjualan` (
  `id_detail` int(11) NOT NULL,
  `id_penjualan` int(11) NOT NULL,
  `id_barang` int(11) NOT NULL,
  `id_gudang` int(11) NOT NULL,
  `jumlah` int(11) NOT NULL,
  `created_at` datetime DEFAULT current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel detail_pembelian (bergantung pada pembelian dan barang)
CREATE TABLE `detail_pembelian` (
  `id_detail` int(11) NOT NULL,
  `id_pembelian` int(11) NOT NULL,
  `id_barang` int(11) NOT NULL,
  `jumlah` int(11) NOT NULL,
  `created_at` datetime DEFAULT current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel detail_penerimaan (bergantung pada penerimaan_barang, barang, dan gudang)
CREATE TABLE `detail_penerimaan` (
  `id_detail` int(11) NOT NULL,
  `id_penerimaan` int(11) NOT NULL,
  `id_barang` int(11) NOT NULL,
  `jumlah_diterima` int(11) NOT NULL,
  `jumlah_dipesan` int(11) DEFAULT NULL,
  `id_gudang` int(11) NOT NULL,
  `keterangan` text DEFAULT NULL,
  `created_at` datetime DEFAULT current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel detail_transfer_stok (bergantung pada transfer_stok dan barang)
CREATE TABLE `detail_transfer_stok` (
  `id_detail` int(11) NOT NULL,
  `id_transfer` int(11) NOT NULL,
  `id_barang` int(11) NOT NULL,
  `jumlah` int(11) NOT NULL,
  `created_at` datetime DEFAULT current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel detail_packing (bergantung pada packing dan barang)
CREATE TABLE `detail_packing` (
  `id_detail` int(11) NOT NULL,
  `id_packing` int(11) NOT NULL,
  `id_barang` int(11) NOT NULL,
  `jumlah` int(11) NOT NULL,
  `created_at` datetime DEFAULT current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel detail_retur_penjualan (bergantung pada retur_penjualan, barang, dan gudang)
CREATE TABLE `detail_retur_penjualan` (
  `id_detail_retur` int(11) NOT NULL,
  `id_retur` int(11) NOT NULL,
  `id_barang` int(11) NOT NULL,
  `id_gudang` int(11) NOT NULL,
  `jumlah_retur` int(11) NOT NULL,
  `jumlah_disetujui` int(11) DEFAULT 0 COMMENT 'Jumlah yang disetujui untuk retur',
  `alasan_barang` text DEFAULT NULL,
  `created_at` datetime DEFAULT current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel detail_retur_pembelian (bergantung pada retur_pembelian, barang, dan gudang)
CREATE TABLE `detail_retur_pembelian` (
  `id_detail_retur_beli` int(11) NOT NULL,
  `id_retur_beli` int(11) NOT NULL,
  `id_barang` int(11) NOT NULL,
  `id_gudang` int(11) NOT NULL,
  `jumlah_retur` int(11) NOT NULL,
  `jumlah_disetujui` int(11) DEFAULT 0 COMMENT 'Jumlah yang disetujui untuk retur',
  `alasan_barang` text DEFAULT NULL,
  `created_at` datetime DEFAULT current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel log_stok (bergantung pada barang, user, perusahaan, dan gudang)
CREATE TABLE `log_stok` (
  `id_log` int(11) NOT NULL,
  `id_barang` int(11) NOT NULL,
  `id_user` int(11) DEFAULT NULL,
  `id_perusahaan` int(11) NOT NULL,
  `id_gudang` int(11) NOT NULL,
  `jenis` enum('masuk','keluar','retur_penjualan','retur_pembelian','transfer_keluar','transfer_masuk','penyesuaian') NOT NULL,
  `jumlah` int(11) NOT NULL,
  `sisa_stok` int(11) NOT NULL,
  `keterangan` text DEFAULT NULL,
  `tanggal` datetime DEFAULT current_timestamp(),
  `id_referensi` int(11) DEFAULT NULL COMMENT 'ID transaksi terkait (penjualan/penerimaan/retur/transfer)',
  `tipe_referensi` enum('penjualan','penerimaan','retur_penjualan','retur_pembelian','transfer','penyesuaian') DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel log_status_transaksi (bergantung pada user)
CREATE TABLE `log_status_transaksi` (
  `id_log` int(11) NOT NULL,
  `id_transaksi` int(11) NOT NULL,
  `tipe_transaksi` enum('penjualan','pembelian','penerimaan','retur_penjualan','retur_pembelian','transfer_stok','packing') NOT NULL,
  `id_user` int(11) NOT NULL,
  `status` varchar(20) NOT NULL,
  `tanggal` datetime NOT NULL DEFAULT current_timestamp(),
  `keterangan` text DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- View v_stok_realtime (bergantung pada stok_gudang, barang, gudang, dan perusahaan)
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `v_stok_realtime`  AS 
SELECT 
  `sg`.`id_barang` AS `id_barang`,
  `sg`.`id_gudang` AS `id_gudang`,
  `b`.`nama_barang` AS `nama_barang`,
  `g`.`nama_gudang` AS `nama_gudang`,
  `sg`.`jumlah` AS `jumlah`,
  `sg`.`reserved` AS `reserved`,
  `sg`.`jumlah` - `sg`.`reserved` AS `stok_tersedia`,
  `b`.`satuan` AS `satuan`,
  `p`.`nama_perusahaan` AS `nama_perusahaan`
FROM (((`stok_gudang` `sg` 
JOIN `barang` `b` ON(`sg`.`id_barang` = `b`.`id_barang`)) 
JOIN `gudang` `g` ON(`sg`.`id_gudang` = `g`.`id_gudang`)) 
JOIN `perusahaan` `p` ON(`sg`.`id_perusahaan` = `p`.`id_perusahaan`)) 
WHERE `b`.`status_aktif` = 1 AND `g`.`status_aktif` = 1 AND `p`.`status_aktif` = 1;

-- Data untuk tabel perusahaan
INSERT INTO `perusahaan` (`id_perusahaan`, `nama_perusahaan`, `alamat`, `telepon`, `email`, `status_aktif`, `deleted_at`, `created_at`, `updated_at`) VALUES
(1, 'PT. Maju Bersama', 'Jl. Sudirman No. 10, Jakarta', '021-12345678', '', 1, NULL, '2025-09-15 22:53:59', '2025-09-17 12:09:24'),
(6, 'asdas', 'asdas', 'asdas', '', 0, NULL, '2025-09-17 17:55:05', '2025-09-19 09:42:54'),
(8, 'rwrwrw', 'werw', '', '', 1, NULL, '2025-09-17 18:36:54', '2025-09-20 05:25:09'),
(9, 'fghjk', 'gfhjk;', '', '', 1, NULL, '2025-09-20 05:34:24', '2025-09-20 06:18:52');

-- Data untuk tabel role_user
INSERT INTO `role_user` (`id_role`, `nama_role`, `deskripsi`) VALUES
(1, 'Super Admin', 'Mengelola semua perusahaan'),
(2, 'Admin Perusahaan', 'Mengelola seluruh data dan transaksi dalam lingkup perusahaannya'),
(3, 'Sales Online', 'Melakukan input penjualan ke konsumen, tidak menyimpan stok'),
(4, 'Admin Packing', 'Menangani proses packing, pengiriman, dan konfirmasi barang sampai'),
(5, 'Admin Return', 'Memproses verifikasi dan approval retur barang');

-- Data untuk tabel menu
INSERT INTO `menu` (`id_menu`, `nama_menu`, `url`, `permission`, `icon`, `deskripsi`, `urutan`, `id_parent`, `status_aktif`, `tipe`) VALUES
(1, 'Dashboard', 'dashboard', NULL, 'fas fa-tachometer-alt', NULL, 1, NULL, 1, 'menu'),
(2, 'Setup', '#', NULL, 'fas fa-database', NULL, 2, NULL, 1, 'menu'),
(3, 'Kategori Barang', 'setup/kategori', NULL, 'fas fa-tags', NULL, 2, 2, 1, 'submenu'),
(4, 'Barang', 'setup/barang', NULL, 'fas fa-box', NULL, 3, 2, 1, 'submenu'),
(5, 'Gudang', 'setup/gudang', NULL, 'fas fa-warehouse', NULL, 4, 2, 1, 'submenu'),
(6, 'Pelanggan', 'setup/pelanggan', NULL, 'fas fa-users', NULL, 5, 2, 1, 'submenu'),
(7, 'Supplier', 'setup/supplier', NULL, 'fas fa-truck', NULL, 6, 2, 1, 'submenu'),
(8, 'User Management', '#', NULL, 'fas fa-user-cog', NULL, 7, 2, 0, 'submenu'),
(9, 'Sales', 'setup/user/sales', NULL, 'fas fa-user-tag', NULL, 7, 2, 1, 'submenu'),
(10, 'Admin Packing', 'setup/user/packing', NULL, 'fas fa-user-cog', NULL, 8, 2, 1, 'submenu'),
(11, 'Aktifitas', '#', NULL, 'fas fa-exchange-alt', NULL, 4, NULL, 1, 'menu'),
(12, 'Pemindahan Barang', 'aktifitas/pemindahan', NULL, 'fas fa-truck-loading', NULL, 1, 11, 1, 'submenu'),
(13, 'Penerimaan Barang', 'aktifitas/penerimaan', NULL, 'fas fa-clipboard-check', NULL, 2, 11, 1, 'submenu'),
(14, 'Retur Penjualan', 'aktifitas/retur_penjualan', NULL, 'fas fa-undo-alt', NULL, 3, 11, 1, 'submenu'),
(15, 'Retur Pembelian', 'aktifitas/retur_pembelian', NULL, 'fas fa-undo', NULL, 4, 11, 1, 'submenu'),
(16, 'Daftar', '#', NULL, 'fas fa-list', NULL, 3, NULL, 1, 'menu'),
(17, 'Pemindahan Barang', 'daftar/pemindahan', NULL, 'fas fa-truck', NULL, 1, 16, 1, 'submenu'),
(18, 'Penerimaan Barang', 'daftar/penerimaan', NULL, 'fas fa-clipboard-list', NULL, 2, 16, 1, 'submenu'),
(19, 'Retur Penjualan', 'daftar/retur_penjualan', NULL, 'fas fa-undo-alt', NULL, 3, 16, 1, 'submenu'),
(20, 'Retur Pembelian', 'daftar/retur_pembelian', NULL, 'fas fa-undo', NULL, 4, 16, 1, 'submenu'),
(21, 'Laporan', '#', NULL, 'fas fa-chart-bar', NULL, 5, NULL, 1, 'menu'),
(22, 'Sales', 'laporan/sales', NULL, 'fas fa-chart-line', NULL, 1, 21, 1, 'submenu'),
(23, 'Packing', 'laporan/packing', NULL, 'fas fa-boxes', NULL, 2, 21, 1, 'submenu'),
(24, 'Mutasi Barang', 'laporan/mutasi', NULL, 'fas fa-exchange-alt', NULL, 3, 21, 1, 'submenu'),
(25, 'Ringkasan Stok', 'laporan/summary', NULL, 'fas fa-file-invoice-dollar', NULL, 4, 21, 1, 'submenu'),
(26, 'Pengaturan', '#', NULL, 'fas fa-cog', NULL, 6, NULL, 1, 'menu'),
(27, 'Stok Awal', 'pengaturan/stok_awal', NULL, 'fas fa-dolly-flatbed', NULL, 1, 26, 1, 'submenu'),
(28, 'Hak Akses', 'pengaturan/hak_akses', NULL, 'fas fa-user-shield', NULL, 2, 26, 1, 'submenu'),
(29, 'Approval Flow', 'pengaturan/approval', NULL, 'fas fa-tasks', NULL, 3, 26, 1, 'submenu'),
(30, 'Pengaturan Sistem', 'pengaturan/sistem', NULL, 'fas fa-sliders-h', NULL, 4, 26, 1, 'submenu'),
(31, 'Perusahaan', 'setup/perusahaan', NULL, 'fas fa-building', NULL, 1, 2, 1, 'submenu');

-- Data untuk tabel user
INSERT INTO `user` (`id_user`, `nama`, `username`, `password_hash`, `id_role`, `id_perusahaan`, `email`, `telepon`, `created_by`, `aktif`, `created_at`, `updated_at`, `last_login`, `foto_profil`, `remember_token`, `token_expires`) VALUES
(1, 'Super Admin', 'admin', '$2y$10$Jk0IyD8hFSY6CbpX5MJtD.3GlVjw.g9hAVM/rymsjmza2cnTl02aq', 1, NULL, 'admin@example.com', '081234567890', NULL, 1, '2025-09-16 00:13:33', NULL, '2025-09-20 07:03:20', NULL, NULL, NULL),
(2, 'Admin Perusahaan', 'adminperusahaan', '$2y$10$Jk0IyD8hFSY6CbpX5MJtD.3GlVjw.g9hAVM/rymsjmza2cnTl02aq', 2, 1, 'admin@perusahaan.com', '081234567891', NULL, 1, '2025-09-16 00:13:33', NULL, '2025-09-20 06:53:05', NULL, NULL, NULL),
(3, 'Sales Online', 'sales', '$2y$10$Jk0IyD8hFSY6CbpX5MJtD.3GlVjw.g9hAVM/rymsjmza2cnTl02aq', 3, 1, 'sales@perusahaan.com', '081234567892', NULL, 1, '2025-09-16 00:13:33', NULL, '2025-09-20 04:29:15', NULL, NULL, NULL),
(4, 'Admin Packing', 'packing', '$2y$10$Jk0IyD8hFSY6CbpX5MJtD.3GlVjw.g9hAVM/rymsjmza2cnTl02aq', 4, 1, 'packing@perusahaan.com', '081234567893', NULL, 1, '2025-09-16 00:13:33', NULL, NULL, NULL, NULL, NULL),
(5, 'Admin Return', 'return', '$2y$10$Jk0IyD8hFSY6CbpX5MJtD.3GlVjw.g9hAVM/rymsjmza2cnTl02aq', 5, 1, 'return@perusahaan.com', '081234567894', NULL, 1, '2025-09-16 00:13:33', NULL, NULL, NULL, NULL, NULL);

-- Data untuk tabel kategori
INSERT INTO `kategori` (`id_kategori`, `id_perusahaan`, `nama_kategori`, `deskripsi`, `status_aktif`, `deleted_at`, `created_at`, `updated_at`) VALUES
(1, 1, 'asdas', 'asdnaskjd', 1, NULL, '2025-09-18 00:28:37', NULL);

-- Data untuk tabel gudang
INSERT INTO `gudang` (`id_gudang`, `id_perusahaan`, `nama_gudang`, `alamat`, `telepon`, `created_by`, `status_aktif`, `deleted_at`, `created_at`, `updated_at`) VALUES
(1, 1, 'Gudang Utama', 'Alamat Gudang Utama', '02112345679', NULL, 1, NULL, '2025-09-16 00:12:08', NULL),
(2, 1, 'Gudang Jakarta Timur', '124fhgbknlm,', '', 1, 1, NULL, '2025-09-17 19:01:45', '2025-09-20 06:18:46');

-- Data untuk tabel pelanggan
INSERT INTO `pelanggan` (`id_pelanggan`, `id_perusahaan`, `nama_pelanggan`, `alamat`, `telepon`, `email`, `tipe_pelanggan`, `status_aktif`, `deleted_at`, `created_at`, `updated_at`) VALUES
(1, 1, 'asdas', 'asdas', '', '', 'konsumen', 1, NULL, '2025-09-19 10:18:12', '2025-09-19 10:18:24');

-- Data untuk tabel supplier
INSERT INTO `supplier` (`id_supplier`, `id_perusahaan`, `nama_supplier`, `alamat`, `telepon`, `email`, `kontak_person`, `status_aktif`, `deleted_at`, `created_at`, `updated_at`) VALUES
(1, 1, 'asdasdas', 'asd', '', '', NULL, 1, NULL, '2025-09-19 10:17:53', '2025-09-19 10:18:02');

-- Data untuk tabel barang
INSERT INTO `barang` (`id_barang`, `id_perusahaan`, `id_kategori`, `nama_barang`, `gambar`, `sku`, `deskripsi`, `satuan`, `status_aktif`, `deleted_at`, `created_at`, `updated_at`) VALUES
(1, 1, 1, '1', '1758329220_stocks.png', '1', '', '1', 1, NULL, '2025-09-20 02:47:00', '2025-09-20 02:47:00'),
(2, 1, 1, '5', '1758338937_stocks.png', '5', '', '1', 1, NULL, '2025-09-20 05:28:57', '2025-09-20 05:28:57'),
(3, 1, 1, '6', '1758339043_stocks.png', '6', '', '1', 1, NULL, '2025-09-20 05:30:43', '2025-09-20 05:30:43'),
(4, 1, 1, '7', '1758339357_stocks.png', '7', '', '7', 1, NULL, '2025-09-20 05:35:57', '2025-09-20 05:35:57'),
(5, 1, 1, '8', '1758339775_large01.jpg', '89', '', 's', 1, NULL, '2025-09-20 05:42:55', '2025-09-20 05:42:55'),
(6, 1, 1, 'n,askn', '1758343470_large01.jpg', 'bkj', '', '1', 1, NULL, '2025-09-20 06:44:31', '2025-09-20 06:44:31'),
(7, 1, 1, 'barang nya di edit', '1758344019_stocks.png', 'alksdkas', '', 'asd', 1, NULL, '2025-09-20 06:53:39', '2025-09-20 06:53:39');

-- Data untuk tabel approval_flow
INSERT INTO `approval_flow` (`id_approval`, `tipe_transaksi`, `status_dari`, `status_ke`, `id_role`, `urutan`, `status_aktif`) VALUES
(1, 'penjualan', 'Draft', 'Packing', 4, 1, 1), (2, 'penjualan', 'Packing', 'Shipping', 4, 2, 1), (3, 'penjualan', 'Shipping', 'Delivered', 4, 3, 1), (4, 'penjualan', 'Draft', 'Cancelled', 4, 4, 1), (5, 'penjualan', 'Packing', 'Cancelled', 4, 5, 1), (6, 'penjualan', 'Shipping', 'Cancelled', 4, 6, 1), (7, 'transfer_stok', 'Draft', 'Packing', 4, 1, 1), (8, 'transfer_stok', 'Packing', 'Shipping', 4, 2, 1), (9, 'transfer_stok', 'Shipping', 'Delivered', 4, 3, 1), (10, 'transfer_stok', 'Draft', 'Cancelled', 4, 4, 1), (11, 'transfer_stok', 'Packing', 'Cancelled', 4, 5, 1), (12, 'transfer_stok', 'Shipping', 'Cancelled', 4, 6, 1), (13, 'pembelian', 'Draft', 'Received', 2, 1, 1), (14, 'pembelian', 'Received', 'Completed', 2, 2, 1), (15, 'pembelian', 'Draft', 'Cancelled', 2, 3, 1), (16, 'pembelian', 'Received', 'Cancelled', 2, 4, 1), (17, 'penerimaan', 'Draft', 'Received', 2, 1, 1), (18, 'penerimaan', 'Received', 'Completed', 2, 2, 1), (19, 'penerimaan', 'Draft', 'Cancelled', 2, 3, 1), (20, 'penerimaan', 'Received', 'Cancelled', 2, 4, 1), (21, 'retur_penjualan', 'Requested', 'Verification', 5, 1, 1), (22, 'retur_penjualan', 'Verification', 'Approved', 5, 2, 1), (23, 'retur_penjualan', 'Verification', 'Rejected', 5, 3, 1), (24, 'retur_penjualan', 'Approved', 'Completed', 5, 4, 1), (25, 'retur_pembelian', 'Requested', 'Verification', 5, 1, 1), (26, 'retur_pembelian', 'Verification', 'Approved', 5, 2, 1), (27, 'retur_pembelian', 'Verification', 'Rejected', 5, 3, 1), (28, 'retur_pembelian', 'Approved', 'Completed', 5, 4, 1);

-- Data untuk tabel hak_akses_menu
INSERT INTO `hak_akses_menu` (`id_hak_akses`, `id_role`, `id_menu`, `can_view`, `can_create`, `can_edit`, `can_delete`) VALUES
(1, 1, 1, 1, 1, 1, 1), (2, 1, 2, 1, 1, 1, 1), (3, 1, 3, 1, 1, 1, 1), (4, 1, 4, 1, 1, 1, 1), (5, 1, 5, 1, 1, 1, 1), (6, 1, 6, 1, 1, 1, 1), (7, 1, 7, 1, 1, 1, 1), (8, 1, 8, 1, 1, 1, 1), (9, 1, 9, 1, 1, 1, 1), (10, 1, 10, 1, 1, 1, 1), (11, 1, 11, 1, 1, 1, 1), (12, 1, 12, 1, 1, 1, 1), (13, 1, 13, 1, 1, 1, 1), (14, 1, 14, 1, 1, 1, 1), (15, 1, 15, 1, 1, 1, 1), (16, 1, 16, 1, 1, 1, 1), (17, 1, 17, 1, 1, 1, 1), (18, 1, 18, 1, 1, 1, 1), (19, 1, 19, 1, 1, 1, 1), (20, 1, 20, 1, 1, 1, 1), (21, 1, 21, 1, 1, 1, 1), (22, 1, 22, 1, 1, 1, 1), (23, 1, 23, 1, 1, 1, 1), (24, 1, 24, 1, 1, 1, 1), (25, 1, 25, 1, 1, 1, 1), (26, 1, 26, 1, 1, 1, 1), (27, 1, 27, 1, 1, 1, 1), (28, 1, 28, 1, 1, 1, 1), (29, 1, 29, 1, 1, 1, 1), (30, 1, 30, 1, 1, 1, 1), (32, 2, 1, 1, 1, 1, 1), (33, 2, 2, 1, 1, 1, 1), (34, 2, 3, 1, 1, 1, 1), (35, 2, 4, 1, 1, 1, 1), (36, 2, 5, 1, 1, 1, 1), (37, 2, 6, 1, 1, 1, 1), (38, 2, 7, 1, 1, 1, 1), (39, 2, 8, 1, 1, 1, 1), (40, 2, 9, 1, 1, 1, 1), (41, 2, 10, 1, 1, 1, 1), (42, 2, 11, 1, 1, 1, 1), (43, 2, 12, 1, 1, 1, 1), (44, 2, 13, 1, 1, 1, 1), (45, 2, 14, 1, 1, 1, 1), (46, 2, 15, 1, 1, 1, 1), (47, 2, 16, 1, 1, 1, 1), (48, 2, 17, 1, 1, 1, 1), (49, 2, 18, 1, 1, 1, 1), (50, 2, 19, 1, 1, 1, 1), (51, 2, 20, 1, 1, 1, 1), (52, 2, 21, 1, 1, 1, 1), (53, 2, 22, 1, 1, 1, 1), (54, 2, 23, 1, 1, 1, 1), (55, 2, 24, 1, 1, 1, 1), (56, 2, 25, 1, 1, 1, 1), (57, 2, 26, 1, 1, 1, 1), (58, 2, 27, 1, 1, 1, 1), (59, 2, 28, 1, 1, 1, 1), (60, 2, 29, 1, 1, 1, 1), (61, 2, 30, 1, 1, 1, 1), (63, 3, 1, 1, 0, 0, 0), (64, 3, 2, 1, 0, 0, 0), (65, 3, 4, 1, 0, 0, 0), (66, 3, 6, 1, 0, 0, 0), (67, 3, 11, 1, 0, 0, 0), (68, 3, 13, 1, 0, 0, 0), (69, 3, 14, 1, 0, 0, 0), (70, 3, 15, 1, 0, 0, 0), (71, 3, 16, 1, 0, 0, 0), (72, 3, 18, 1, 0, 0, 0), (73, 3, 19, 1, 0, 0, 0), (74, 3, 20, 1, 0, 0, 0), (75, 3, 21, 1, 0, 0, 0), (76, 3, 22, 1, 0, 0, 0), (77, 4, 1, 1, 0, 0, 0), (78, 4, 11, 1, 0, 0, 0), (79, 4, 12, 1, 0, 0, 0), (80, 4, 13, 1, 0, 0, 0), (81, 4, 16, 1, 0, 0, 0), (82, 4, 17, 1, 0, 0, 0), (83, 4, 18, 1, 0, 0, 0), (84, 4, 21, 1, 0, 0, 0), (85, 4, 23, 1, 0, 0, 0), (86, 5, 1, 1, 0, 0, 0), (87, 5, 11, 1, 0, 0, 0), (88, 5, 14, 1, 0, 0, 0), (89, 5, 15, 1, 0, 0, 0), (90, 5, 16, 1, 0, 0, 0), (91, 5, 19, 1, 0, 0, 0), (92, 5, 20, 1, 0, 0, 0), (93, 1, 31, 1, 1, 1, 1), (94, 2, 31, 1, 1, 1, 1);

-- Indexes dan constraints untuk semua tabel
ALTER TABLE `approval_flow`
  ADD PRIMARY KEY (`id_approval`),
  ADD KEY `tipe_transaksi` (`tipe_transaksi`),
  ADD KEY `id_role` (`id_role`);

ALTER TABLE `barang`
  ADD PRIMARY KEY (`id_barang`),
  ADD UNIQUE KEY `uniq_sku_perusahaan` (`id_perusahaan`,`sku`),
  ADD KEY `id_kategori` (`id_kategori`);

ALTER TABLE `detail_packing`
  ADD PRIMARY KEY (`id_detail`),
  ADD KEY `id_packing` (`id_packing`),
  ADD KEY `id_barang` (`id_barang`);

ALTER TABLE `detail_pembelian`
  ADD PRIMARY KEY (`id_detail`),
  ADD KEY `id_pembelian` (`id_pembelian`),
  ADD KEY `id_barang` (`id_barang`);

ALTER TABLE `detail_penerimaan`
  ADD PRIMARY KEY (`id_detail`),
  ADD KEY `id_penerimaan` (`id_penerimaan`),
  ADD KEY `id_barang` (`id_barang`),
  ADD KEY `id_gudang` (`id_gudang`);

ALTER TABLE `detail_penjualan`
  ADD PRIMARY KEY (`id_detail`),
  ADD KEY `fk_penjualan_detail` (`id_penjualan`),
  ADD KEY `fk_barang_penjualan` (`id_barang`),
  ADD KEY `fk_gudang_penjualan` (`id_gudang`);

ALTER TABLE `detail_retur_pembelian`
  ADD PRIMARY KEY (`id_detail_retur_beli`),
  ADD KEY `id_retur_beli` (`id_retur_beli`),
  ADD KEY `id_barang` (`id_barang`),
  ADD KEY `id_gudang` (`id_gudang`);

ALTER TABLE `detail_retur_penjualan`
  ADD PRIMARY KEY (`id_detail_retur`),
  ADD KEY `fk_retur` (`id_retur`),
  ADD KEY `fk_barang` (`id_barang`),
  ADD KEY `fk_gudang` (`id_gudang`);

ALTER TABLE `detail_transfer_stok`
  ADD PRIMARY KEY (`id_detail`),
  ADD KEY `id_transfer` (`id_transfer`),
  ADD KEY `id_barang` (`id_barang`);

ALTER TABLE `gudang`
  ADD PRIMARY KEY (`id_gudang`),
  ADD KEY `id_perusahaan` (`id_perusahaan`),
  ADD KEY `gudang_ibfk_2` (`created_by`);

ALTER TABLE `hak_akses_menu`
  ADD PRIMARY KEY (`id_hak_akses`),
  ADD UNIQUE KEY `uniq_role_menu` (`id_role`,`id_menu`),
  ADD KEY `hak_akses_menu_ibfk_2` (`id_menu`);

ALTER TABLE `kategori`
  ADD PRIMARY KEY (`id_kategori`),
  ADD UNIQUE KEY `uniq_kategori_perusahaan` (`id_perusahaan`,`nama_kategori`);

ALTER TABLE `log_status_transaksi`
  ADD PRIMARY KEY (`id_log`),
  ADD KEY `id_transaksi` (`id_transaksi`),
  ADD KEY `id_user` (`id_user`),
  ADD KEY `tipe_transaksi` (`tipe_transaksi`);

ALTER TABLE `log_stok`
  ADD PRIMARY KEY (`id_log`),
  ADD KEY `idx_barang` (`id_barang`),
  ADD KEY `idx_gudang` (`id_gudang`),
  ADD KEY `idx_perusahaan` (`id_perusahaan`),
  ADD KEY `idx_referensi` (`id_referensi`),
  ADD KEY `idx_tipe_referensi` (`tipe_referensi`),
  ADD KEY `log_stok_ibfk_2` (`id_user`);

ALTER TABLE `menu`
  ADD PRIMARY KEY (`id_menu`),
  ADD KEY `id_parent` (`id_parent`);

ALTER TABLE `packing`
  ADD PRIMARY KEY (`id_packing`),
  ADD KEY `id_referensi` (`id_referensi`),
  ADD KEY `id_user` (`id_user`);

ALTER TABLE `pelanggan`
  ADD PRIMARY KEY (`id_pelanggan`),
  ADD KEY `pelanggan_ibfk_1` (`id_perusahaan`);

ALTER TABLE `pembelian`
  ADD PRIMARY KEY (`id_pembelian`),
  ADD KEY `id_perusahaan` (`id_perusahaan`),
  ADD KEY `pembelian_ibfk_2` (`id_user`),
  ADD KEY `pembelian_ibfk_3` (`id_supplier`);

ALTER TABLE `penerimaan_barang`
  ADD PRIMARY KEY (`id_penerimaan`),
  ADD KEY `id_pembelian` (`id_pembelian`),
  ADD KEY `id_user` (`id_user`),
  ADD KEY `id_gudang` (`id_gudang`);

ALTER TABLE `pengaturan_sistem`
  ADD PRIMARY KEY (`id_pengaturan`),
  ADD UNIQUE KEY `uniq_key` (`key`);

ALTER TABLE `penjualan`
  ADD PRIMARY KEY (`id_penjualan`),
  ADD KEY `id_perusahaan` (`id_perusahaan`),
  ADD KEY `penjualan_ibfk_2` (`id_user`),
  ADD KEY `penjualan_ibfk_3` (`id_pelanggan`);

ALTER TABLE `perusahaan`
  ADD PRIMARY KEY (`id_perusahaan`);

ALTER TABLE `retur_pembelian`
  ADD PRIMARY KEY (`id_retur_beli`),
  ADD KEY `id_pembelian` (`id_pembelian`),
  ADD KEY `id_user` (`id_user`),
  ADD KEY `id_supplier` (`id_supplier`);

ALTER TABLE `retur_penjualan`
  ADD PRIMARY KEY (`id_retur`),
  ADD KEY `id_penjualan` (`id_penjualan`),
  ADD KEY `id_user` (`id_user`);

ALTER TABLE `role_user`
  ADD PRIMARY KEY (`id_role`);

ALTER TABLE `stok_awal`
  ADD PRIMARY KEY (`id_stok_awal`),
  ADD KEY `fk_stok_awal_barang` (`id_barang`),
  ADD KEY `fk_stok_awal_gudang` (`id_gudang`),
  ADD KEY `fk_stok_awal_perusahaan` (`id_perusahaan`),
  ADD KEY `stok_awal_ibfk_4` (`created_by`);

ALTER TABLE `stok_gudang`
  ADD PRIMARY KEY (`id_stok`),
  ADD UNIQUE KEY `uniq_barang_gudang` (`id_barang`,`id_gudang`),
  ADD KEY `stok_gudang_ibfk_1` (`id_perusahaan`),
  ADD KEY `stok_gudang_ibfk_2` (`id_gudang`);

ALTER TABLE `supplier`
  ADD PRIMARY KEY (`id_supplier`),
  ADD KEY `supplier_ibfk_1` (`id_perusahaan`);

ALTER TABLE `transfer_stok`
  ADD PRIMARY KEY (`id_transfer`),
  ADD KEY `id_perusahaan` (`id_perusahaan`),
  ADD KEY `id_gudang_asal` (`id_gudang_asal`),
  ADD KEY `id_gudang_tujuan` (`id_gudang_tujuan`),
  ADD KEY `id_user` (`id_user`);

ALTER TABLE `user`
  ADD PRIMARY KEY (`id_user`),
  ADD UNIQUE KEY `username` (`username`),
  ADD KEY `id_role` (`id_role`),
  ADD KEY `id_perusahaan` (`id_perusahaan`),
  ADD KEY `user_ibfk_3` (`created_by`);

-- AUTO_INCREMENT untuk semua tabel
ALTER TABLE `approval_flow`
  MODIFY `id_approval` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=29;

ALTER TABLE `barang`
  MODIFY `id_barang` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=8;

ALTER TABLE `detail_packing`
  MODIFY `id_detail` int(11) NOT NULL AUTO_INCREMENT;

ALTER TABLE `detail_pembelian`
  MODIFY `id_detail` int(11) NOT NULL AUTO_INCREMENT;

ALTER TABLE `detail_penerimaan`
  MODIFY `id_detail` int(11) NOT NULL AUTO_INCREMENT;

ALTER TABLE `detail_penjualan`
  MODIFY `id_detail` int(11) NOT NULL AUTO_INCREMENT;

ALTER TABLE `detail_retur_pembelian`
  MODIFY `id_detail_retur_beli` int(11) NOT NULL AUTO_INCREMENT;

ALTER TABLE `detail_retur_penjualan`
  MODIFY `id_detail_retur` int(11) NOT NULL AUTO_INCREMENT;

ALTER TABLE `detail_transfer_stok`
  MODIFY `id_detail` int(11) NOT NULL AUTO_INCREMENT;

ALTER TABLE `gudang`
  MODIFY `id_gudang` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=3;

ALTER TABLE `hak_akses_menu`
  MODIFY `id_hak_akses` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=105;

ALTER TABLE `kategori`
  MODIFY `id_kategori` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=2;

ALTER TABLE `log_status_transaksi`
  MODIFY `id_log` int(11) NOT NULL AUTO_INCREMENT;

ALTER TABLE `log_stok`
  MODIFY `id_log` int(11) NOT NULL AUTO_INCREMENT;

ALTER TABLE `menu`
  MODIFY `id_menu` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=33;

ALTER TABLE `packing`
  MODIFY `id_packing` int(11) NOT NULL AUTO_INCREMENT;

ALTER TABLE `pelanggan`
  MODIFY `id_pelanggan` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=2;

ALTER TABLE `pembelian`
  MODIFY `id_pembelian` int(11) NOT NULL AUTO_INCREMENT;

ALTER TABLE `penerimaan_barang`
  MODIFY `id_penerimaan` int(11) NOT NULL AUTO_INCREMENT;

ALTER TABLE `pengaturan_sistem`
  MODIFY `id_pengaturan` int(11) NOT NULL AUTO_INCREMENT;

ALTER TABLE `penjualan`
  MODIFY `id_penjualan` int(11) NOT NULL AUTO_INCREMENT;

ALTER TABLE `perusahaan`
  MODIFY `id_perusahaan` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=10;

ALTER TABLE `retur_pembelian`
  MODIFY `id_retur_beli` int(11) NOT NULL AUTO_INCREMENT;

ALTER TABLE `retur_penjualan`
  MODIFY `id_retur` int(11) NOT NULL AUTO_INCREMENT;

ALTER TABLE `role_user`
  MODIFY `id_role` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=6;

ALTER TABLE `stok_awal`
  MODIFY `id_stok_awal` int(11) NOT NULL AUTO_INCREMENT;

ALTER TABLE `stok_gudang`
  MODIFY `id_stok` int(11) NOT NULL AUTO_INCREMENT;

ALTER TABLE `supplier`
  MODIFY `id_supplier` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=2;

ALTER TABLE `transfer_stok`
  MODIFY `id_transfer` int(11) NOT NULL AUTO_INCREMENT;

ALTER TABLE `user`
  MODIFY `id_user` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=6;

-- Constraints untuk semua tabel
ALTER TABLE `approval_flow`
  ADD CONSTRAINT `approval_flow_ibfk_1` FOREIGN KEY (`id_role`) REFERENCES `role_user` (`id_role`);

ALTER TABLE `barang`
  ADD CONSTRAINT `barang_ibfk_1` FOREIGN KEY (`id_kategori`) REFERENCES `kategori` (`id_kategori`),
  ADD CONSTRAINT `barang_ibfk_2` FOREIGN KEY (`id_perusahaan`) REFERENCES `perusahaan` (`id_perusahaan`);

ALTER TABLE `detail_packing`
  ADD CONSTRAINT `detail_packing_ibfk_1` FOREIGN KEY (`id_packing`) REFERENCES `packing` (`id_packing`),
  ADD CONSTRAINT `detail_packing_ibfk_2` FOREIGN KEY (`id_barang`) REFERENCES `barang` (`id_barang`);

ALTER TABLE `detail_pembelian`
  ADD CONSTRAINT `detail_pembelian_ibfk_1` FOREIGN KEY (`id_pembelian`) REFERENCES `pembelian` (`id_pembelian`),
  ADD CONSTRAINT `detail_pembelian_ibfk_2` FOREIGN KEY (`id_barang`) REFERENCES `barang` (`id_barang`);

ALTER TABLE `detail_penerimaan`
  ADD CONSTRAINT `detail_penerimaan_ibfk_1` FOREIGN KEY (`id_penerimaan`) REFERENCES `penerimaan_barang` (`id_penerimaan`),
  ADD CONSTRAINT `detail_penerimaan_ibfk_2` FOREIGN KEY (`id_barang`) REFERENCES `barang` (`id_barang`),
  ADD CONSTRAINT `detail_penerimaan_ibfk_3` FOREIGN KEY (`id_gudang`) REFERENCES `gudang` (`id_gudang`);

ALTER TABLE `detail_penjualan`
  ADD CONSTRAINT `detail_penjualan_ibfk_1` FOREIGN KEY (`id_penjualan`) REFERENCES `penjualan` (`id_penjualan`),
  ADD CONSTRAINT `detail_penjualan_ibfk_2` FOREIGN KEY (`id_barang`) REFERENCES `barang` (`id_barang`),
  ADD CONSTRAINT `detail_penjualan_ibfk_3` FOREIGN KEY (`id_gudang`) REFERENCES `gudang` (`id_gudang`);

ALTER TABLE `detail_retur_pembelian`
  ADD CONSTRAINT `detail_retur_pembelian_ibfk_1` FOREIGN KEY (`id_retur_beli`) REFERENCES `retur_pembelian` (`id_retur_beli`),
  ADD CONSTRAINT `detail_retur_pembelian_ibfk_2` FOREIGN KEY (`id_barang`) REFERENCES `barang` (`id_barang`),
  ADD CONSTRAINT `detail_retur_pembelian_ibfk_3` FOREIGN KEY (`id_gudang`) REFERENCES `gudang` (`id_gudang`);

ALTER TABLE `detail_retur_penjualan`
  ADD CONSTRAINT `detail_retur_penjualan_ibfk_1` FOREIGN KEY (`id_retur`) REFERENCES `retur_penjualan` (`id_retur`),
  ADD CONSTRAINT `detail_retur_penjualan_ibfk_2` FOREIGN KEY (`id_barang`) REFERENCES `barang` (`id_barang`),
  ADD CONSTRAINT `detail_retur_penjualan_ibfk_3` FOREIGN KEY (`id_gudang`) REFERENCES `gudang` (`id_gudang`);

ALTER TABLE `detail_transfer_stok`
  ADD CONSTRAINT `detail_transfer_stok_ibfk_1` FOREIGN KEY (`id_transfer`) REFERENCES `transfer_stok` (`id_transfer`),
  ADD CONSTRAINT `detail_transfer_stok_ibfk_2` FOREIGN KEY (`id_barang`) REFERENCES `barang` (`id_barang`);

ALTER TABLE `gudang`
  ADD CONSTRAINT `gudang_ibfk_1` FOREIGN KEY (`id_perusahaan`) REFERENCES `perusahaan` (`id_perusahaan`),
  ADD CONSTRAINT `gudang_ibfk_2` FOREIGN KEY (`created_by`) REFERENCES `user` (`id_user`);

ALTER TABLE `hak_akses_menu`
  ADD CONSTRAINT `hak_akses_menu_ibfk_1` FOREIGN KEY (`id_role`) REFERENCES `role_user` (`id_role`),
  ADD CONSTRAINT `hak_akses_menu_ibfk_2` FOREIGN KEY (`id_menu`) REFERENCES `menu` (`id_menu`);

ALTER TABLE `kategori`
  ADD CONSTRAINT `kategori_ibfk_1` FOREIGN KEY (`id_perusahaan`) REFERENCES `perusahaan` (`id_perusahaan`);

ALTER TABLE `log_status_transaksi`
  ADD CONSTRAINT `log_status_transaksi_ibfk_1` FOREIGN KEY (`id_user`) REFERENCES `user` (`id_user`);

ALTER TABLE `log_stok`
  ADD CONSTRAINT `log_stok_ibfk_1` FOREIGN KEY (`id_barang`) REFERENCES `barang` (`id_barang`),
  ADD CONSTRAINT `log_stok_ibfk_2` FOREIGN KEY (`id_user`) REFERENCES `user` (`id_user`),
  ADD CONSTRAINT `log_stok_ibfk_3` FOREIGN KEY (`id_perusahaan`) REFERENCES `perusahaan` (`id_perusahaan`),
  ADD CONSTRAINT `log_stok_ibfk_4` FOREIGN KEY (`id_gudang`) REFERENCES `gudang` (`id_gudang`);

ALTER TABLE `menu`
  ADD CONSTRAINT `menu_ibfk_1` FOREIGN KEY (`id_parent`) REFERENCES `menu` (`id_menu`);

ALTER TABLE `packing`
  ADD CONSTRAINT `packing_ibfk_1` FOREIGN KEY (`id_user`) REFERENCES `user` (`id_user`);

ALTER TABLE `pelanggan`
  ADD CONSTRAINT `pelanggan_ibfk_1` FOREIGN KEY (`id_perusahaan`) REFERENCES `perusahaan` (`id_perusahaan`);

ALTER TABLE `pembelian`
  ADD CONSTRAINT `pembelian_ibfk_1` FOREIGN KEY (`id_perusahaan`) REFERENCES `perusahaan` (`id_perusahaan`),
  ADD CONSTRAINT `pembelian_ibfk_2` FOREIGN KEY (`id_user`) REFERENCES `user` (`id_user`),
  ADD CONSTRAINT `pembelian_ibfk_3` FOREIGN KEY (`id_supplier`) REFERENCES `supplier` (`id_supplier`);

ALTER TABLE `penerimaan_barang`
  ADD CONSTRAINT `penerimaan_barang_ibfk_1` FOREIGN KEY (`id_pembelian`) REFERENCES `pembelian` (`id_pembelian`),
  ADD CONSTRAINT `penerimaan_barang_ibfk_2` FOREIGN KEY (`id_user`) REFERENCES `user` (`id_user`),
  ADD CONSTRAINT `penerimaan_barang_ibfk_3` FOREIGN KEY (`id_gudang`) REFERENCES `gudang` (`id_gudang`);

ALTER TABLE `penjualan`
  ADD CONSTRAINT `penjualan_ibfk_1` FOREIGN KEY (`id_perusahaan`) REFERENCES `perusahaan` (`id_perusahaan`),
  ADD CONSTRAINT `penjualan_ibfk_2` FOREIGN KEY (`id_user`) REFERENCES `user` (`id_user`),
  ADD CONSTRAINT `penjualan_ibfk_3` FOREIGN KEY (`id_pelanggan`) REFERENCES `pelanggan` (`id_pelanggan`);

ALTER TABLE `retur_pembelian`
  ADD CONSTRAINT `retur_pembelian_ibfk_1` FOREIGN KEY (`id_pembelian`) REFERENCES `pembelian` (`id_pembelian`),
  ADD CONSTRAINT `retur_pembelian_ibfk_2` FOREIGN KEY (`id_user`) REFERENCES `user` (`id_user`),
  ADD CONSTRAINT `retur_pembelian_ibfk_3` FOREIGN KEY (`id_supplier`) REFERENCES `supplier` (`id_supplier`);

ALTER TABLE `retur_penjualan`
  ADD CONSTRAINT `retur_penjualan_ibfk_1` FOREIGN KEY (`id_penjualan`) REFERENCES `penjualan` (`id_penjualan`),
  ADD CONSTRAINT `retur_penjualan_ibfk_2` FOREIGN KEY (`id_user`) REFERENCES `user` (`id_user`);

ALTER TABLE `stok_awal`
  ADD CONSTRAINT `stok_awal_ibfk_1` FOREIGN KEY (`id_barang`) REFERENCES `barang` (`id_barang`),
  ADD CONSTRAINT `stok_awal_ibfk_2` FOREIGN KEY (`id_gudang`) REFERENCES `gudang` (`id_gudang`),
  ADD CONSTRAINT `stok_awal_ibfk_3` FOREIGN KEY (`id_perusahaan`) REFERENCES `perusahaan` (`id_perusahaan`),
  ADD CONSTRAINT `stok_awal_ibfk_4` FOREIGN KEY (`created_by`) REFERENCES `user` (`id_user`);

ALTER TABLE `stok_gudang`
  ADD CONSTRAINT `stok_gudang_ibfk_1` FOREIGN KEY (`id_perusahaan`) REFERENCES `perusahaan` (`id_perusahaan`),
  ADD CONSTRAINT `stok_gudang_ibfk_2` FOREIGN KEY (`id_gudang`) REFERENCES `gudang` (`id_gudang`),
  ADD CONSTRAINT `stok_gudang_ibfk_3` FOREIGN KEY (`id_barang`) REFERENCES `barang` (`id_barang`);

ALTER TABLE `supplier`
  ADD CONSTRAINT `supplier_ibfk_1` FOREIGN KEY (`id_perusahaan`) REFERENCES `perusahaan` (`id_perusahaan`);

ALTER TABLE `transfer_stok`
  ADD CONSTRAINT `transfer_stok_ibfk_1` FOREIGN KEY (`id_perusahaan`) REFERENCES `perusahaan` (`id_perusahaan`),
  ADD CONSTRAINT `transfer_stok_ibfk_2` FOREIGN KEY (`id_gudang_asal`) REFERENCES `gudang` (`id_gudang`),
  ADD CONSTRAINT `transfer_stok_ibfk_3` FOREIGN KEY (`id_gudang_tujuan`) REFERENCES `gudang` (`id_gudang`),
  ADD CONSTRAINT `transfer_stok_ibfk_4` FOREIGN KEY (`id_user`) REFERENCES `user` (`id_user`);

ALTER TABLE `user`
  ADD CONSTRAINT `user_ibfk_1` FOREIGN KEY (`id_role`) REFERENCES `role_user` (`id_role`),
  ADD CONSTRAINT `user_ibfk_2` FOREIGN KEY (`id_perusahaan`) REFERENCES `perusahaan` (`id_perusahaan`),
  ADD CONSTRAINT `user_ibfk_3` FOREIGN KEY (`created_by`) REFERENCES `user` (`id_user`);


gudang_system/
â”œâ”€â”€ application/
â”‚   â”œâ”€â”€ cache/
â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â”œâ”€â”€ autoload.php
â”‚   â”‚   â”œâ”€â”€ config.php
â”‚   â”‚   â”œâ”€â”€ constants.php
â”‚   â”‚   â”œâ”€â”€ database.php
â”‚   â”‚   â”œâ”€â”€ doctypes.php
â”‚   â”‚   â”œâ”€â”€ foreign_chars.php
â”‚   â”‚   â”œâ”€â”€ hooks.php
â”‚   â”‚   â”œâ”€â”€ index.html
â”‚   â”‚   â”œâ”€â”€ memcached.php
â”‚   â”‚   â”œâ”€â”€ migration.php
â”‚   â”‚   â”œâ”€â”€ mimes.php
â”‚   â”‚   â”œâ”€â”€ profiler.php
â”‚   â”‚   â”œâ”€â”€ routes.php
â”‚   â”‚   â”œâ”€â”€ smileys.php
â”‚   â”‚   â””â”€â”€ user_agents.php
â”‚   â”œâ”€â”€ controllers/
â”‚   â”‚   â”œâ”€â”€ Auth.php
â”‚   â”‚   â”œâ”€â”€ Dashboard.php
â”‚   â”‚   â”œâ”€â”€ Setup/
â”‚   â”‚   â”‚   â”œâ”€â”€ Perusahaan.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Kategori.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Barang.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Gudang.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Pelanggan.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Supplier.php
â”‚   â”‚   â”‚   â””â”€â”€ User.php
â”‚   â”‚   â”œâ”€â”€ Aktifitas/
â”‚   â”‚   â”‚   â”œâ”€â”€ Pemindahan.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Penerimaan.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Retur_penjualan.php
â”‚   â”‚   â”‚   â””â”€â”€ Retur_pembelian.php
â”‚   â”‚   â”œâ”€â”€ Daftar/
â”‚   â”‚   â”‚   â”œâ”€â”€ Pemindahan.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Penerimaan.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Retur_penjualan.php
â”‚   â”‚   â”‚   â””â”€â”€ Retur_pembelian.php
â”‚   â”‚   â”œâ”€â”€ Laporan/
â”‚   â”‚   â”‚   â”œâ”€â”€ Sales.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Packing.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Mutasi.php
â”‚   â”‚   â”‚   â””â”€â”€ Summary.php
â”‚   â”‚   â”œâ”€â”€ Pengaturan/
â”‚   â”‚   â”‚   â”œâ”€â”€ Stok_awal.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Hak_akses.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Approval.php
â”‚   â”‚   â”‚   â””â”€â”€ Sistem.php
â”‚   â”‚   â””â”€â”€ index.html
â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”œâ”€â”€ MY_Controller.php
â”‚   â”‚   â”œâ”€â”€ MY_Model.php
â”‚   â”‚   â””â”€â”€ index.html
â”‚   â”œâ”€â”€ helpers/
â”‚   â”‚   â”œâ”€â”€ company_filter_helper.php
â”‚   â”‚   â”œâ”€â”€ menu_helper.php
â”‚   â”‚   â”œâ”€â”€ stok_helper.php
â”‚   â”‚   â”œâ”€â”€ index.html
â”‚   â”‚   â””â”€â”€ app_helper.php
â”‚   â”œâ”€â”€ libraries/
â”‚   â”‚   â”œâ”€â”€ Auth.php
â”‚   â”‚   â”œâ”€â”€ Menu.php
â”‚   â”‚   â”œâ”€â”€ Stok.php
â”‚   â”‚   â””â”€â”€ index.html
â”‚   â”œâ”€â”€ logs/
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”œâ”€â”€ Auth_model.php
â”‚   â”‚   â”œâ”€â”€ Detail_pembelian_model.php
â”‚   â”‚   â”œâ”€â”€ Detail_penjualan_model.php
â”‚   â”‚   â”œâ”€â”€ Log_status_transaksi_model.php
â”‚   â”‚   â”œâ”€â”€ Log_stok_model.php
â”‚   â”‚   â”œâ”€â”€ Menu_model.php
â”‚   â”‚   â”œâ”€â”€ Pembelian_model.php
â”‚   â”‚   â”œâ”€â”€ Penjualan_model.php
â”‚   â”‚   â”œâ”€â”€ Stok_gudang_model.php
â”‚   â”‚   â”œâ”€â”€ Stok_model.php
â”‚   â”‚   â”œâ”€â”€ Setup/
â”‚   â”‚   â”‚   â”œâ”€â”€ Barang_model.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Gudang_model.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Kategori_model.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Pelanggan_model.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Perusahaan_model.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Stok_gudang_model.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Supplier_model.php
â”‚   â”‚   â”‚   â””â”€â”€ User_model.php
â”‚   â”‚   â”œâ”€â”€ Aktifitas/
â”‚   â”‚   â”‚   â”œâ”€â”€ Pemindahan_model.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Penerimaan_model.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Retur_penjualan_model.php
â”‚   â”‚   â”‚   â””â”€â”€ Retur_pembelian_model.php
â”‚   â”‚   â”œâ”€â”€ Daftar/
â”‚   â”‚   â”‚   â”œâ”€â”€ Pemindahan_model.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Penerimaan_model.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Retur_penjualan_model.php
â”‚   â”‚   â”‚   â””â”€â”€ Retur_pembelian_model.php
â”‚   â”‚   â”œâ”€â”€ Laporan/
â”‚   â”‚   â”‚   â”œâ”€â”€ Sales_model.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Packing_model.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Mutasi_model.php
â”‚   â”‚   â”‚   â””â”€â”€ Summary_model.php
â”‚   â”‚   â”œâ”€â”€ Pengaturan/
â”‚   â”‚   â”‚   â”œâ”€â”€ Stok_awal_model.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Hak_akses_model.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Approval_model.php
â”‚   â”‚   â”‚   â””â”€â”€ Sistem_model.php
â”‚   â”‚   â””â”€â”€ index.html
â”œâ”€â”€ views/application/views/
    â”œâ”€â”€ auth/
    â”‚   â”œâ”€â”€ login.php
    â”œâ”€â”€ errors/
    â”‚   â”œâ”€â”€ error_general.php
    â”‚   â””â”€â”€ error_404.php
    â”œâ”€â”€ layout/
    â”‚   â”œâ”€â”€ header.php
    â”‚   â”œâ”€â”€ top_menu.php
    â”‚   â”œâ”€â”€ footer.php
    â”‚   â”œâ”€â”€ js.php
    â”‚   â””â”€â”€ modal.php
    â”‚   â””â”€â”€ woding.php
    â”œâ”€â”€ dashboard/
    â”‚   â””â”€â”€ index.php
    â”œâ”€â”€ setup/
    â”‚   â”œâ”€â”€ kategori/
    â”‚   â”‚   â”œâ”€â”€ index.php      
    â”‚   â”‚   â”œâ”€â”€ form.php       
    â”‚   â”‚   â””â”€â”€ detail.php     
    â”‚   â”œâ”€â”€ barang/
    â”‚   â”‚   â”œâ”€â”€ index.php      
    â”‚   â”‚   â”œâ”€â”€ form.php       
    â”‚   â”‚   â”œâ”€â”€ detail.php     
    â”‚   â”‚   â””â”€â”€ stok.php       
    â”‚   â”œâ”€â”€ gudang/
    â”‚   â”‚   â”œâ”€â”€ index.php      
    â”‚   â”‚   â”œâ”€â”€ form.php       
    â”‚   â”‚   â””â”€â”€ detail.php     
    â”‚   â”œâ”€â”€ pelanggan/
    â”‚   â”‚   â”œâ”€â”€ index.php      
    â”‚   â”‚   â”œâ”€â”€ form.php       
    â”‚   â”‚   â””â”€â”€ detail.php      
    â”‚   â”œâ”€â”€ perusahaan/
    â”‚   â”‚   â”œâ”€â”€ index.php      
    â”‚   â”‚   â”œâ”€â”€ form.php       
    â”‚   â”‚   â””â”€â”€ detail.php     
    â”‚   â”œâ”€â”€ supplier/
    â”‚   â”‚   â”œâ”€â”€ index.php      
    â”‚   â”‚   â”œâ”€â”€ form.php       
    â”‚   â”‚   â””â”€â”€ detail.php     
    â”‚   â””â”€â”€ user/
    â”‚       â”œâ”€â”€ index.php      
    â”‚       â”œâ”€â”€ form.php       
    â”‚       â”œâ”€â”€ profile.php    
    â”‚       â””â”€â”€ change_password.php
    â”‚       â””â”€â”€ reset_password.php
    â”‚       â””â”€â”€ detail.php
    â”‚       â””â”€â”€ form_edit.php
    â”‚       â””â”€â”€ form_packing.php
    â”‚       â””â”€â”€ form_sales.php
    â”‚       â””â”€â”€ packing.php
    â”‚       â””â”€â”€ sales.php
    â”œâ”€â”€ aktifitas/
    â”‚   â”œâ”€â”€ pemindahan/
    â”‚   â”‚   â”œâ”€â”€ index.php      
    â”‚   â”‚   â”œâ”€â”€ form.php       
    â”‚   â”‚   â”œâ”€â”€ detail.php     
    â”‚   â”œâ”€â”€ penerimaan/
    â”‚   â”‚   â”œâ”€â”€ index.php      
    â”‚   â”‚   â”œâ”€â”€ form.php       
    â”‚   â”‚   â”œâ”€â”€ detail.php     
    â”‚   â”œâ”€â”€ retur_penjualan/
    â”‚   â”‚   â”œâ”€â”€ index.php      
    â”‚   â”‚   â”œâ”€â”€ form.php
    â”‚   â”‚   â”œâ”€â”€ detail.php     
    â”‚   â”‚   â””â”€â”€ verifikasi.php 
    â”‚   â””â”€â”€ retur_pembelian/
    â”‚       â”œâ”€â”€ index.php      
    â”‚       â”œâ”€â”€ form.php
    â”‚       â”œâ”€â”€ detail.php     
    â”‚       â””â”€â”€ verifikasi.php 
    â”œâ”€â”€ daftar/
    â”‚   â”œâ”€â”€ pemindahan/
    â”‚   â”‚   â”œâ”€â”€ cetak.php      
    â”‚   â”‚   â”œâ”€â”€ index.php      
    â”‚   â”‚   â””â”€â”€ detail.php     
    â”‚   â”œâ”€â”€ penerimaan/
    â”‚   â”‚   â”œâ”€â”€ cetak.php      
    â”‚   â”‚   â”œâ”€â”€ index.php      
    â”‚   â”‚   â””â”€â”€ detail.php     
    â”‚   â”œâ”€â”€ retur_penjualan/
    â”‚   â”‚   â”œâ”€â”€ cetak.php      
    â”‚   â”‚   â”œâ”€â”€ index.php      
    â”‚   â”‚   â””â”€â”€ detail.php    
    â”‚   â””â”€â”€ retur_pembelian/
    â”‚   â”‚   â”œâ”€â”€ cetak.php      
    â”‚   â”‚   â”œâ”€â”€ index.php      
    â”‚   â”‚   â””â”€â”€ detail.php    
    â”œâ”€â”€ laporan/
    â”‚   â”œâ”€â”€ sales/
    â”‚   â”‚   â”œâ”€â”€ index.php      
    â”‚   â”‚   â”œâ”€â”€ filter.php     
    â”‚   â”œâ”€â”€ packing/
    â”‚   â”‚   â”œâ”€â”€ index.php      
    â”‚   â”‚   â”œâ”€â”€ detail.php     
    â”‚   â”œâ”€â”€ mutasi/
    â”‚   â”‚   â”œâ”€â”€ index.php      
    â”‚   â””â”€â”€ summary/
    â”‚       â”œâ”€â”€ index.php      
    â”œâ”€â”€ pengaturan/
    â”‚   â”œâ”€â”€ stok_awal/
    â”‚   â”‚   â”œâ”€â”€ index.php      
    â”‚   â”‚   â”œâ”€â”€ form.php       
    â”‚   â”‚   â””â”€â”€ import.php     
    â”‚   â”œâ”€â”€ hak_akses/
    â”‚   â”‚   â”œâ”€â”€ index.php      
    â”‚   â”‚   â”œâ”€â”€ form_role.php       
    â”‚   â”‚   â””â”€â”€ role.php       
    â”‚   â”œâ”€â”€ approval/
    â”‚   â”‚   â”œâ”€â”€ index.php      
    â”‚   â”‚   â”œâ”€â”€ form.php       
    â”‚   â”‚   â””â”€â”€ diagram.php    
    â”‚   â””â”€â”€ sistem/
    â”‚       â”œâ”€â”€ index.php      
    â”‚       â”œâ”€â”€ backup.php     
    â”‚       â””â”€â”€ log.php   
    â”‚       â””â”€â”€ view_log.php   
â”œâ”€â”€ assets/
â”‚   â”œâ”€â”€ css/
â”‚   â”œâ”€â”€ js/
â”‚   â”œâ”€â”€ images/
â”‚   â””â”€â”€ plugins/
â”œâ”€â”€ system/
â”œâ”€â”€ uploads/
â”‚   â”œâ”€â”€ images/
â”‚   â”œâ”€â”€ documents/
â”‚   â””â”€â”€ temp/
â”‚   â””â”€â”€ user/
â”‚   â””â”€â”€ barang/
â”œâ”€â”€ index.php
â”œâ”€â”€ license.txt
â”œâ”€â”€ README.md
â””â”€â”€ .htaccess

Tahapan Pembangunan Sistem Manajemen Stok Gudang (per modul)
1. Pondasi Sistem
Autentikasi:
Modul login & logout
Session management
Middleware role & hak akses menu
Template:
Integrasi SB Admin 2 (header, sidebar, footer, dashboard dummy)
Dinamisasi sidebar dari tabel menu + hak_akses_menu

2. Modul Setup (Master Data)
2.1 Perusahaan & Gudang
Form input/edit perusahaan
Form input/edit gudang (relasi ke perusahaan)
List perusahaan & gudang

2.2 Kategori & Barang
Form kategori barang
Form barang (relasi ke kategori & perusahaan)
Stok awal barang per gudang (stok_awal â†’ update ke stok_gudang)

2.3 User & Role
CRUD user
Mapping role ke menu (Super Admin, Admin Perusahaan, Sales, Packing, Return)

2.4 Supplier & Pelanggan
CRUD supplier
CRUD pelanggan (perusahaan â†’ pelanggan distributor)
âœ… Setelah modul ini jadi â†’ sistem sudah siap punya master data lengkap.

3. Modul Transaksi Utama
3.1 Pembelian
Header pembelian + detail barang
Status: Draft â†’ Menunggu Penerimaan
Belum update stok (stok bertambah di penerimaan)

3.2 Penerimaan Barang
Header penerimaan_barang + detail
Relasi ke pembelian
Status: Draft â†’ Received â†’ Completed
Saat Received â†’ update stok_gudang & log_stok

3.3 Penjualan
Header penjualan + detail barang
Status: Draft â†’ Packing â†’ Shipping â†’ Delivered â†’ Completed
Saat Shipping â†’ stok gudang berkurang + log stok
Integrasi dengan role Sales (user hanya bisa input penjualan, stok tetap dari gudang)

3.4 Transfer Stok
Header transfer_stok + detail barang
Status: Draft â†’ Packing â†’ Shipping â†’ Delivered
Saat Shipping â†’ kurangi stok gudang asal
Saat Delivered â†’ tambah stok gudang tujuan
Catat ke log_stok

3.5 Retur
Retur Penjualan (retur_penjualan + detail)
Requested â†’ Verification â†’ Approved â†’ Completed
Approved â†’ tambah stok ke gudang
Retur Pembelian (retur_pembelian + detail)
Requested â†’ Verification â†’ Approved â†’ Completed
Approved â†’ kurangi stok dari gudang
âœ… Setelah semua transaksi ini beres â†’ sistem sudah bisa jalan penuh dari input barang â†’ pembelian â†’ stok masuk â†’ penjualan â†’ stok keluar â†’ retur.

4. Audit & Approval
Implementasi log_status_transaksi untuk semua transaksi
Catat siapa user yang update status & kapan
Approval flow per role:
Admin Return â†’ approve/reject retur
Admin Packing â†’ approve status packing & shipping
Admin Perusahaan â†’ kontrol penuh transaksi perusahaannya
Super Admin â†’ bisa lihat semua

5. Modul Laporan
5.1 Laporan Sales
Detail penjualan per pelanggan/konsumen
Filter per tanggal, perusahaan, gudang

5.2 Laporan Packing
Daftar aktivitas packing & pengiriman

5.3 Laporan Mutasi
Mutasi barang per gudang
Data dari log_stok

5.4 Laporan Summary
Ringkasan stok per barang & per gudang:
Saldo awal
Masuk
Keluar
Saldo akhi