Lanjut di chat baru karena chat lama sudah limit.
kita sedang membangun sistem ya bro, berikut detail nya

ðŸ“„ Rancangan Sistem Manajemen Stok Gudang
1. Gambaran Umum
Sistem ini dirancang untuk mendukung manajemen stok gudang yang dapat menampung beberapa perusahaan. Sistem ini mencatat stok keluar-masuk, dan juga memastikan setiap proses memiliki status & approval yang jelas. Hal ini penting untuk tracking, akurasi stok, dan transparansi, dengan fitur yang lengkap mulai dari penerimaan barang, pemindahan antar gudang, hingga proses retur. Sistem ini tidak mencatat harga, sebab hanya berfokus pada barang dan jumlah item nya saja.
Aplikasi akan dikembangkan menggunakan CodeIgniter 3.1.13 dengan tampilan berbasis SB Admin 2 (Bootstrap 4), serta database MySQL.

2. Fitur Utama
2.1 Multi Perusahaan
    a. Sistem mendukung banyak perusahaan sekaligus.
    b. Data dipisahkan berdasarkan perusahaan (barang, gudang, pelanggan, supplier, stok).

2.2 Manajemen Hak Akses (Role-Based Access)
Hak akses diatur berdasarkan role:
    1. Super Admin â†’ mengelola semua perusahaan.
    2. Admin Perusahaan â†’ mengelola seluruh data dan transaksi dalam lingkup perusahaannya.
    3. Sales Online â†’ melakukan input pemindahan barang ke konsumen milik sales sendiri.
    4. Admin Packing â†’ menangani proses packing, pengiriman, dan konfirmasi barang sampai.
    5. Admin Return â†’ memproses verifikasi dan approval retur barang.

3. Menu Aktifitas
3.1 Pemindahan Barang
Pemindahan barang bisa berupa:
    1. Gudang â†’ Gudang lain (internal transfer).
    2. Gudang â†’ Pelanggan (distributor resmi).
    3. Gudang â†’ Konsumen (melalui pemindahan barang ke konsumen milik Sales).
Catatan: Sales tidak memiliki stok. Barang tetap diambil dari gudang.

Alur Status Pemindahan:
    a. Draft â†’ transaksi baru dibuat.
    b. Packing â†’ barang sedang diproses untuk dikemas.
    c. Shipping â†’ barang dalam proses pengiriman, stok gudang sudah dikurangi.
    d. Delivered â†’ barang diterima tujuan, transaksi selesai.
    e. Cancelled â†’ pemindahan dibatalkan (stok dikembalikan jika sudah dikurangi).

3.2 Penerimaan Barang
    a. Input nomor penerimaan (berdasarkan supplier).
    b. Input detail barang yang masuk ke gudang.

Alur Status Penerimaan:
    a. Draft â†’ data penerimaan dibuat.
    b. Received â†’ barang sudah dicatat masuk, stok gudang bertambah.
    c. Completed â†’ penerimaan selesai diproses.
    d. Cancelled â†’ penerimaan dibatalkan.

3.3 Retur Barang Penjualan
Yaitu retur barang dari pelanggan/konsumen.
Alur Status Retur:
    a.Requested â†’ retur diajukan.
    b.Verification â†’ barang diperiksa oleh Admin Return.
    c.Approved â†’ retur diterima, stok gudang bertambah
    d.Rejected â†’ retur ditolak, tidak ada perubahan stok.
    e.Completed â†’ retur selesai diproses.

3.4 Retur Barang Pembelian
Yaitu retur barang ke supplier.
Alur Status Retur:
    a.Requested â†’ retur diajukan.
    b.Verification â†’ barang diperiksa oleh Admin Return.
    c.Approved â†’ retur diterima, stok gudang berkurang
    d.Rejected â†’ retur ditolak, tidak ada perubahan stok.
    e.Completed â†’ retur selesai diproses.

4. Menu Setup
    1. Perusahaan â†’ master data Perusahaa.
    2. Kategori â†’ master data kategori barang (per perusahaan).
    3. Barang â†’ master data barang (relasi ke perusahaan & kategori).
    4. Gudang â†’ daftar gudang per perusahaan.
    5. Sales â†’ user dengan role Sales Online Per perusahaan.
    6. Admin Packing â†’ user dengan role Admin Packing per perusahaan.
    7. Pelanggan â†’ distributor resmi per perusahaan.
    8. Supplier â†’ pemasok per perusahaan.

5. Menu Laporan
    1. Laporan Sales â†’ detail pengirimin barang ke konsumen/pelanggan milik sales sendiri.
    2. Laporan Packing â†’ aktivitas pengiriman & pekerjaan Admin Packing.
    3. Laporan Mutasi â†’ pergerakan barang antar gudang & transaksi keluar/masuk.
    4. Laporan Summary â†’ ringkasan stok masuk, keluar, dan saldo akhir (stok akhir).


untuk menu sendiri akan dibuat dengan posisi top_menu dan susunannya seperti ini
â”œDashboard
â”œSetup
â”‚ â”œPerusahaan
â”‚ â”œKategori Barang
â”‚ â”œBarang
â”‚ â”œGudang
â”‚ â”œPelanggan
â”‚ â””Supplier
â”‚ â”œSales
â”‚ â”œAdmin Packing
â”œAktifitas
â”‚ â”œPemindahan Barang
â”‚ â”œPenerimaan Barang
â”‚ â”œRetur Penjualan
â”‚ â””Retur Pembelian
â”œDaftar
â”‚ â”œPemindahan Barang
â”‚ â”œPenerimaan Barang
â”‚ â”œRetur Penjualan
â”‚ â””Retur Pembelian
â”œLaporan
â”‚ â”œSales
â”‚ â”œPacking
â”‚ â”œMutasi Barang
â”‚ â””Ringkasan Stok
Pengaturan
â”‚ â”œStok Awal
â”‚ â”œHak Akses
â”‚ â”œApproval Flow
â”‚ â””Pengaturan Sistem


database yang digunakan yaitu

DROP DATABASE IF EXISTS gudang_system;
CREATE DATABASE gudang_system CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;
USE gudang_system;

-- Tabel perusahaan (tidak memiliki dependensi)
CREATE TABLE `perusahaan` (
  `id_perusahaan` int(11) NOT NULL AUTO_INCREMENT,
  `nama_perusahaan` varchar(255) NOT NULL,
  `alamat` varchar(255) DEFAULT NULL,
  `telepon` varchar(20) DEFAULT NULL,
  `email` varchar(100) DEFAULT NULL,
  `status_aktif` tinyint(1) DEFAULT 1,
  `deleted_at` datetime DEFAULT NULL,
  `created_at` datetime DEFAULT current_timestamp(),
  `updated_at` datetime DEFAULT NULL,
  PRIMARY KEY (`id_perusahaan`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel role_user (tidak memiliki dependensi)
CREATE TABLE `role_user` (
  `id_role` int(11) NOT NULL AUTO_INCREMENT,
  `nama_role` varchar(50) NOT NULL,
  `deskripsi` text DEFAULT NULL,
  PRIMARY KEY (`id_role`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel pengaturan_sistem (tidak memiliki dependensi)
CREATE TABLE `pengaturan_sistem` (
  `id_pengaturan` int(11) NOT NULL AUTO_INCREMENT,
  `key` varchar(50) NOT NULL,
  `value` text DEFAULT NULL,
  `keterangan` text DEFAULT NULL,
  PRIMARY KEY (`id_pengaturan`),
  UNIQUE KEY `uniq_key` (`key`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel menu (tidak memiliki dependensi)
CREATE TABLE `menu` (
  `id_menu` int(11) NOT NULL AUTO_INCREMENT,
  `nama_menu` varchar(50) NOT NULL,
  `url` varchar(100) DEFAULT NULL,
  `permission` varchar(50) DEFAULT NULL,
  `icon` varchar(50) DEFAULT NULL,
  `deskripsi` text DEFAULT NULL,
  `urutan` int(11) DEFAULT 0,
  `id_parent` int(11) DEFAULT NULL,
  `status_aktif` tinyint(1) DEFAULT 1,
  `tipe` enum('menu','submenu') NOT NULL DEFAULT 'menu',
  PRIMARY KEY (`id_menu`),
  KEY `id_parent` (`id_parent`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel toko_konsumen (tidak memiliki dependensi)
CREATE TABLE `toko_konsumen` (
  `id_toko_konsumen` int(11) NOT NULL AUTO_INCREMENT,
  `nama_toko_konsumen` varchar(50) NOT NULL,
  `status_aktif` tinyint(1) DEFAULT 1,
  `created_at` datetime DEFAULT current_timestamp(),
  PRIMARY KEY (`id_toko_konsumen`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel motor (tidak memiliki dependensi)
CREATE TABLE `motor` (
  `id_motor` int(11) NOT NULL AUTO_INCREMENT,
  `nama_motor` varchar(100) NOT NULL,
  `status_aktif` tinyint(1) DEFAULT 1,
  PRIMARY KEY (`id_motor`),
  UNIQUE KEY `uniq_nama_motor` (`nama_motor`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel warna (tidak memiliki dependensi)
CREATE TABLE `warna` (
  `id_warna` int(11) NOT NULL AUTO_INCREMENT,
  `nama_warna` varchar(50) NOT NULL,
  `status_aktif` tinyint(1) DEFAULT 1,
  PRIMARY KEY (`id_warna`),
  UNIQUE KEY `uniq_nama_warna` (`nama_warna`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel user (bergantung pada role_user dan perusahaan)
CREATE TABLE `user` (
  `id_user` int(11) NOT NULL AUTO_INCREMENT,
  `nama` varchar(100) NOT NULL,
  `username` varchar(50) NOT NULL,
  `password_hash` varchar(255) NOT NULL,
  `id_role` int(11) NOT NULL,
  `id_perusahaan` int(11) DEFAULT NULL,
  `email` varchar(100) DEFAULT NULL,
  `telepon` varchar(20) DEFAULT NULL,
  `created_by` int(11) DEFAULT NULL,
  `aktif` tinyint(1) DEFAULT 1,
  `created_at` datetime DEFAULT current_timestamp(),
  `updated_at` datetime DEFAULT NULL,
  `last_login` datetime DEFAULT NULL,
  `foto_profil` varchar(255) DEFAULT NULL,
  `remember_token` varchar(100) DEFAULT NULL,
  `token_expires` datetime DEFAULT NULL,
  PRIMARY KEY (`id_user`),
  UNIQUE KEY `username` (`username`),
  KEY `id_role` (`id_role`),
  KEY `id_perusahaan` (`id_perusahaan`),
  KEY `user_ibfk_3` (`created_by`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel kategori (bergantung pada perusahaan)
CREATE TABLE `kategori` (
  `id_kategori` int(11) NOT NULL AUTO_INCREMENT,
  `id_perusahaan` int(11) NOT NULL,
  `nama_kategori` varchar(50) NOT NULL,
  `deskripsi` text DEFAULT NULL,
  `status_aktif` tinyint(1) DEFAULT 1,
  `deleted_at` datetime DEFAULT NULL,
  `created_at` datetime DEFAULT current_timestamp(),
  `updated_at` datetime DEFAULT NULL,
  PRIMARY KEY (`id_kategori`),
  UNIQUE KEY `uniq_kategori_perusahaan` (`id_perusahaan`,`nama_kategori`),
  KEY `id_perusahaan` (`id_perusahaan`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel gudang (bergantung pada perusahaan dan user)
CREATE TABLE `gudang` (
  `id_gudang` int(11) NOT NULL AUTO_INCREMENT,
  `id_perusahaan` int(11) NOT NULL,
  `nama_gudang` varchar(100) NOT NULL,
  `alamat` text DEFAULT NULL,
  `telepon` varchar(20) DEFAULT NULL,
  `created_by` int(11) DEFAULT NULL,
  `status_aktif` tinyint(1) DEFAULT 1,
  `deleted_at` datetime DEFAULT NULL,
  `created_at` datetime DEFAULT current_timestamp(),
  `updated_at` datetime DEFAULT NULL,
  PRIMARY KEY (`id_gudang`),
  KEY `id_perusahaan` (`id_perusahaan`),
  KEY `gudang_ibfk_2` (`created_by`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel supplier (bergantung pada perusahaan)
CREATE TABLE `supplier` (
  `id_supplier` int(11) NOT NULL AUTO_INCREMENT,
  `id_perusahaan` int(11) NOT NULL,
  `nama_supplier` varchar(100) NOT NULL,
  `alamat` text DEFAULT NULL,
  `telepon` varchar(20) DEFAULT NULL,
  `email` varchar(100) DEFAULT NULL,
  `kontak_person` varchar(100) DEFAULT NULL,
  `status_aktif` tinyint(1) DEFAULT 1,
  `deleted_at` datetime DEFAULT NULL,
  `created_at` datetime DEFAULT current_timestamp(),
  `updated_at` datetime DEFAULT NULL,
  PRIMARY KEY (`id_supplier`),
  KEY `supplier_ibfk_1` (`id_perusahaan`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel konsumen (bergantung pada toko_konsumen dan perusahaan)
CREATE TABLE `konsumen` (
  `id_konsumen` int(11) NOT NULL AUTO_INCREMENT,
  `nama_konsumen` varchar(100) NOT NULL,
  `id_toko_konsumen` int(11) NOT NULL,
  `alamat_konsumen` text DEFAULT NULL,
  `id_perusahaan` int(11) NOT NULL,
  `status_aktif` tinyint(1) DEFAULT 1,
  `created_at` datetime DEFAULT current_timestamp(),
  PRIMARY KEY (`id_konsumen`),
  KEY `id_toko_konsumen` (`id_toko_konsumen`),
  KEY `id_perusahaan` (`id_perusahaan`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel pelanggan (bergantung pada perusahaan dan user) - DITAMBAHKAN id_sales
CREATE TABLE `pelanggan` (
  `id_pelanggan` int(11) NOT NULL AUTO_INCREMENT,
  `id_perusahaan` int(11) NOT NULL,
  `nama_pelanggan` varchar(100) NOT NULL,
  `alamat` text DEFAULT NULL,
  `telepon` varchar(20) DEFAULT NULL,
  `email` varchar(100) DEFAULT NULL,
  `tipe_pelanggan` enum('distributor','konsumen') DEFAULT 'konsumen',
  `id_sales` int(11) DEFAULT NULL,
  `status_aktif` tinyint(1) DEFAULT 1,
  `deleted_at` datetime DEFAULT NULL,
  `created_at` datetime DEFAULT current_timestamp(),
  `updated_at` datetime DEFAULT NULL,
  PRIMARY KEY (`id_pelanggan`),
  KEY `pelanggan_ibfk_1` (`id_perusahaan`),
  KEY `id_sales` (`id_sales`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel barang (bergantung pada kategori dan perusahaan)
CREATE TABLE `barang` (
  `id_barang` int(11) NOT NULL AUTO_INCREMENT,
  `id_perusahaan` int(11) NOT NULL,
  `id_kategori` int(11) DEFAULT NULL,
  `nama_barang` varchar(100) NOT NULL,
  `gambar` varchar(255) DEFAULT NULL,
  `sku` varchar(50) NOT NULL,
  `kode_barang` varchar(100) DEFAULT NULL,
  `ukuran` varchar(100) DEFAULT NULL,
  `deskripsi` text DEFAULT NULL,
  `satuan` varchar(20) DEFAULT NULL,
  `motor` varchar(100) DEFAULT NULL,
  `warna` varchar(100) DEFAULT NULL,
  `status_aktif` tinyint(1) DEFAULT 1,
  `deleted_at` datetime DEFAULT NULL,
  `created_at` datetime DEFAULT current_timestamp(),
  `updated_at` datetime DEFAULT current_timestamp() ON UPDATE current_timestamp(),
  PRIMARY KEY (`id_barang`),
  UNIQUE KEY `uniq_sku_perusahaan` (`id_perusahaan`,`sku`),
  KEY `id_kategori` (`id_kategori`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel stok_gudang (bergantung pada perusahaan, gudang, dan barang)
CREATE TABLE `stok_gudang` (
  `id_stok` int(11) NOT NULL AUTO_INCREMENT,
  `id_perusahaan` int(11) NOT NULL,
  `id_gudang` int(11) NOT NULL,
  `id_barang` int(11) NOT NULL,
  `jumlah` int(11) NOT NULL DEFAULT 0,
  `reserved` int(11) NOT NULL DEFAULT 0 COMMENT 'Jumlah stok yang dipesan tapi belum dikirim',
  `created_at` datetime DEFAULT current_timestamp(),
  `updated_at` datetime DEFAULT current_timestamp() ON UPDATE current_timestamp(),
  PRIMARY KEY (`id_stok`),
  UNIQUE KEY `uniq_barang_gudang` (`id_barang`,`id_gudang`),
  KEY `stok_gudang_ibfk_1` (`id_perusahaan`),
  KEY `stok_gudang_ibfk_2` (`id_gudang`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel stok_awal (bergantung pada barang, gudang, perusahaan, dan user)
CREATE TABLE `stok_awal` (
  `id_stok_awal` int(11) NOT NULL AUTO_INCREMENT,
  `id_barang` int(11) NOT NULL,
  `id_gudang` int(11) NOT NULL,
  `id_perusahaan` int(11) NOT NULL,
  `qty_awal` int(11) NOT NULL,
  `keterangan` text DEFAULT NULL,
  `created_at` datetime DEFAULT current_timestamp(),
  `created_by` int(11) NOT NULL,
  PRIMARY KEY (`id_stok_awal`),
  KEY `fk_stok_awal_barang` (`id_barang`),
  KEY `fk_stok_awal_gudang` (`id_gudang`),
  KEY `fk_stok_awal_perusahaan` (`id_perusahaan`),
  KEY `stok_awal_ibfk_4` (`created_by`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel approval_flow (bergantung pada role_user)
CREATE TABLE `approval_flow` (
  `id_approval` int(11) NOT NULL AUTO_INCREMENT,
  `tipe_transaksi` enum('pemindahan_barang','penerimaan_barang','retur_penjualan','retur_pembelian') NOT NULL,
  `status_dari` varchar(20) NOT NULL,
  `status_ke` varchar(20) NOT NULL,
  `id_role` int(11) NOT NULL,
  `urutan` int(11) NOT NULL,
  `status_aktif` tinyint(1) DEFAULT 1,
  PRIMARY KEY (`id_approval`),
  KEY `tipe_transaksi` (`tipe_transaksi`),
  KEY `id_role` (`id_role`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel hak_akses_menu (bergantung pada role_user dan menu)
CREATE TABLE `hak_akses_menu` (
  `id_hak_akses` int(11) NOT NULL AUTO_INCREMENT,
  `id_role` int(11) NOT NULL,
  `id_menu` int(11) NOT NULL,
  `can_view` tinyint(1) NOT NULL DEFAULT 0,
  `can_create` tinyint(1) NOT NULL DEFAULT 0,
  `can_edit` tinyint(1) NOT NULL DEFAULT 0,
  `can_delete` tinyint(1) NOT NULL DEFAULT 0,
  PRIMARY KEY (`id_hak_akses`),
  UNIQUE KEY `uniq_role_menu` (`id_role`,`id_menu`),
  KEY `hak_akses_menu_ibfk_2` (`id_menu`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel pemindahan_barang (menggantikan penjualan dan transfer_stok)
CREATE TABLE `pemindahan_barang` (
  `id_pemindahan` int(11) NOT NULL AUTO_INCREMENT,
  `id_perusahaan` int(11) NOT NULL,
  `no_transaksi` varchar(50) DEFAULT NULL,
  `id_user` int(11) NOT NULL,
  `id_gudang_asal` int(11) NOT NULL,
  `tipe_tujuan` enum('gudang','pelanggan') NOT NULL,
  `id_gudang_tujuan` int(11) DEFAULT NULL,
  `id_pelanggan` int(11) DEFAULT NULL,
  `id_konsumen` int(11) DEFAULT NULL,
  `tanggal_pemindahan` datetime NOT NULL,
  `keterangan` text DEFAULT NULL,
  `status` enum('Draft','Packing','Shipping','Delivered','Cancelled') DEFAULT 'Draft',
  `deleted_at` datetime DEFAULT NULL,
  `created_at` datetime DEFAULT current_timestamp(),
  `updated_at` datetime DEFAULT NULL,
  PRIMARY KEY (`id_pemindahan`),
  KEY `id_perusahaan` (`id_perusahaan`),
  KEY `id_user` (`id_user`),
  KEY `id_gudang_asal` (`id_gudang_asal`),
  KEY `id_gudang_tujuan` (`id_gudang_tujuan`),
  KEY `id_pelanggan` (`id_pelanggan`),
  KEY `id_konsumen` (`id_konsumen`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel penerimaan_barang (bergantung pada user, supplier, dan gudang)
CREATE TABLE `penerimaan_barang` (
  `id_penerimaan` int(11) NOT NULL AUTO_INCREMENT,
  `no_penerimaan` varchar(50) DEFAULT NULL,
  `id_user` int(11) NOT NULL,
  `id_supplier` int(11) NOT NULL,
  `id_gudang` int(11) NOT NULL,
  `tanggal_penerimaan` datetime NOT NULL,
  `keterangan` text DEFAULT NULL,
  `status` enum('Draft','Received','Completed','Cancelled') DEFAULT 'Draft',
  `created_at` datetime DEFAULT current_timestamp(),
  `updated_at` datetime DEFAULT current_timestamp() ON UPDATE current_timestamp(),
  PRIMARY KEY (`id_penerimaan`),
  KEY `id_user` (`id_user`),
  KEY `id_supplier` (`id_supplier`),
  KEY `id_gudang` (`id_gudang`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel packing (bergantung pada user)
CREATE TABLE `packing` (
  `id_packing` int(11) NOT NULL AUTO_INCREMENT,
  `id_referensi` int(11) NOT NULL COMMENT 'ID dari transaksi terkait (pemindahan_barang)',
  `tipe_referensi` enum('pemindahan_barang') NOT NULL,
  `id_user` int(11) NOT NULL,
  `tanggal_packing` datetime NOT NULL,
  `status` enum('Draft','Packing','Completed','Cancelled') DEFAULT 'Draft',
  `catatan` text DEFAULT NULL,
  `created_at` datetime DEFAULT current_timestamp(),
  `updated_at` datetime DEFAULT current_timestamp() ON UPDATE current_timestamp(),
  PRIMARY KEY (`id_packing`),
  KEY `id_referensi` (`id_referensi`),
  KEY `id_user` (`id_user`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel retur_penjualan (bergantung pada pemindahan_barang dan user)
CREATE TABLE `retur_penjualan` (
  `id_retur` int(11) NOT NULL AUTO_INCREMENT,
  `no_retur` varchar(50) DEFAULT NULL,
  `id_pemindahan` int(11) NOT NULL,
  `id_user` int(11) NOT NULL,
  `tanggal_retur` datetime NOT NULL,
  `alasan_retur` text NOT NULL,
  `status` enum('Requested','Verification','Approved','Rejected','Completed') DEFAULT 'Requested',
  `created_at` datetime DEFAULT current_timestamp(),
  PRIMARY KEY (`id_retur`),
  KEY `id_pemindahan` (`id_pemindahan`),
  KEY `id_user` (`id_user`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel retur_pembelian (bergantung pada penerimaan_barang, user, dan supplier)
CREATE TABLE `retur_pembelian` (
  `id_retur_beli` int(11) NOT NULL AUTO_INCREMENT,
  `no_retur_beli` varchar(50) DEFAULT NULL,
  `id_penerimaan` int(11) NOT NULL,
  `id_user` int(11) NOT NULL,
  `id_supplier` int(11) NOT NULL,
  `tanggal_retur` datetime NOT NULL,
  `alasan_retur` text NOT NULL,
  `status` enum('Requested','Verification','Approved','Rejected','Completed') DEFAULT 'Requested',
  `created_at` datetime DEFAULT current_timestamp(),
  `updated_at` datetime DEFAULT current_timestamp() ON UPDATE current_timestamp(),
  PRIMARY KEY (`id_retur_beli`),
  KEY `id_penerimaan` (`id_penerimaan`),
  KEY `id_user` (`id_user`),
  KEY `id_supplier` (`id_supplier`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel detail_pemindahan_barang (bergantung pada pemindahan_barang, barang, dan gudang)
CREATE TABLE `detail_pemindahan_barang` (
  `id_detail` int(11) NOT NULL AUTO_INCREMENT,
  `id_pemindahan` int(11) NOT NULL,
  `id_barang` int(11) NOT NULL,
  `id_gudang` int(11) NOT NULL,
  `jumlah` int(11) NOT NULL,
  `created_at` datetime DEFAULT current_timestamp(),
  PRIMARY KEY (`id_detail`),
  KEY `id_pemindahan` (`id_pemindahan`),
  KEY `id_barang` (`id_barang`),
  KEY `id_gudang` (`id_gudang`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel detail_penerimaan (bergantung pada penerimaan_barang, barang, dan gudang)
CREATE TABLE `detail_penerimaan` (
  `id_detail` int(11) NOT NULL AUTO_INCREMENT,
  `id_penerimaan` int(11) NOT NULL,
  `id_barang` int(11) NOT NULL,
  `jumlah_diterima` int(11) NOT NULL,
  `jumlah_dipesan` int(11) DEFAULT NULL,
  `id_gudang` int(11) NOT NULL,
  `keterangan` text DEFAULT NULL,
  `created_at` datetime DEFAULT current_timestamp(),
  PRIMARY KEY (`id_detail`),
  KEY `id_penerimaan` (`id_penerimaan`),
  KEY `id_barang` (`id_barang`),
  KEY `id_gudang` (`id_gudang`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel detail_packing (bergantung pada packing dan barang)
CREATE TABLE `detail_packing` (
  `id_detail` int(11) NOT NULL AUTO_INCREMENT,
  `id_packing` int(11) NOT NULL,
  `id_barang` int(11) NOT NULL,
  `jumlah` int(11) NOT NULL,
  `created_at` datetime DEFAULT current_timestamp(),
  PRIMARY KEY (`id_detail`),
  KEY `id_packing` (`id_packing`),
  KEY `id_barang` (`id_barang`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel detail_retur_penjualan (bergantung pada retur_penjualan, barang, dan gudang)
CREATE TABLE `detail_retur_penjualan` (
  `id_detail_retur` int(11) NOT NULL AUTO_INCREMENT,
  `id_retur` int(11) NOT NULL,
  `id_barang` int(11) NOT NULL,
  `id_gudang` int(11) NOT NULL,
  `jumlah_retur` int(11) NOT NULL,
  `jumlah_disetujui` int(11) DEFAULT 0 COMMENT 'Jumlah yang disetujui untuk retur',
  `alasan_barang` text DEFAULT NULL,
  `created_at` datetime DEFAULT current_timestamp(),
  PRIMARY KEY (`id_detail_retur`),
  KEY `id_retur` (`id_retur`),
  KEY `id_barang` (`id_barang`),
  KEY `id_gudang` (`id_gudang`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel detail_retur_pembelian (bergantung pada retur_pembelian, barang, dan gudang)
CREATE TABLE `detail_retur_pembelian` (
  `id_detail_retur_beli` int(11) NOT NULL AUTO_INCREMENT,
  `id_retur_beli` int(11) NOT NULL,
  `id_barang` int(11) NOT NULL,
  `id_gudang` int(11) NOT NULL,
  `jumlah_retur` int(11) NOT NULL,
  `jumlah_disetujui` int(11) DEFAULT 0 COMMENT 'Jumlah yang disetujui untuk retur',
  `alasan_barang` text DEFAULT NULL,
  `created_at` datetime DEFAULT current_timestamp(),
  PRIMARY KEY (`id_detail_retur_beli`),
  KEY `id_retur_beli` (`id_retur_beli`),
  KEY `id_barang` (`id_barang`),
  KEY `id_gudang` (`id_gudang`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel log_stok (bergantung pada barang, user, perusahaan, dan gudang)
CREATE TABLE `log_stok` (
  `id_log` int(11) NOT NULL AUTO_INCREMENT,
  `id_barang` int(11) NOT NULL,
  `id_user` int(11) DEFAULT NULL,
  `id_perusahaan` int(11) NOT NULL,
  `id_gudang` int(11) NOT NULL,
  `jenis` enum('masuk','keluar','retur_penjualan','retur_pembelian','transfer_keluar','transfer_masuk','penyesuaian') NOT NULL,
  `jumlah` int(11) NOT NULL,
  `sisa_stok` int(11) NOT NULL,
  `keterangan` text DEFAULT NULL,
  `tanggal` datetime DEFAULT current_timestamp(),
  `id_referensi` int(11) DEFAULT NULL COMMENT 'ID transaksi terkait (pemindahan_barang/penerimaan_barang/retur)',
  `tipe_referensi` enum('pemindahan_barang','penerimaan_barang','retur_penjualan','retur_pembelian','penyesuaian') DEFAULT NULL,
  PRIMARY KEY (`id_log`),
  KEY `idx_barang` (`id_barang`),
  KEY `idx_gudang` (`id_gudang`),
  KEY `idx_perusahaan` (`id_perusahaan`),
  KEY `idx_referensi` (`id_referensi`),
  KEY `idx_tipe_referensi` (`tipe_referensi`),
  KEY `log_stok_ibfk_2` (`id_user`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- Tabel log_status_transaksi (bergantung pada user)
CREATE TABLE `log_status_transaksi` (
  `id_log` int(11) NOT NULL AUTO_INCREMENT,
  `id_transaksi` int(11) NOT NULL,
  `tipe_transaksi` enum('pemindahan_barang','penerimaan_barang','retur_penjualan','retur_pembelian','packing') NOT NULL,
  `id_user` int(11) NOT NULL,
  `status` varchar(20) NOT NULL,
  `tanggal` datetime NOT NULL DEFAULT current_timestamp(),
  `keterangan` text DEFAULT NULL,
  PRIMARY KEY (`id_log`),
  KEY `id_transaksi` (`id_transaksi`),
  KEY `id_user` (`id_user`),
  KEY `tipe_transaksi` (`tipe_transaksi`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- View v_stok_realtime (bergantung pada stok_gudang, barang, gudang, dan perusahaan)
CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `v_stok_realtime`  AS 
SELECT 
  `sg`.`id_barang` AS `id_barang`,
  `sg`.`id_gudang` AS `id_gudang`,
  `b`.`nama_barang` AS `nama_barang`,
  `g`.`nama_gudang` AS `nama_gudang`,
  `sg`.`jumlah` AS `jumlah`,
  `sg`.`reserved` AS `reserved`,
  `sg`.`jumlah` - `sg`.`reserved` AS `stok_tersedia`,
  `b`.`satuan` AS `satuan`,
  `p`.`nama_perusahaan` AS `nama_perusahaan`
FROM (((`stok_gudang` `sg` 
JOIN `barang` `b` ON(`sg`.`id_barang` = `b`.`id_barang`)) 
JOIN `gudang` `g` ON(`sg`.`id_gudang` = `g`.`id_gudang`)) 
JOIN `perusahaan` `p` ON(`sg`.`id_perusahaan` = `p`.`id_perusahaan`)) 
WHERE `b`.`status_aktif` = 1 AND `g`.`status_aktif` = 1 AND `p`.`status_aktif` = 1;

-- Insert data untuk tabel perusahaan
INSERT INTO `perusahaan` (`id_perusahaan`, `nama_perusahaan`, `alamat`, `telepon`, `email`, `status_aktif`, `deleted_at`, `created_at`, `updated_at`) VALUES
(1, 'PT. MGV MOTORINDO', 'Jl. Sudirman No. 10, Jakarta', '021-12345678', '', 1, NULL, '2025-09-15 22:53:59', '2025-09-17 12:09:24'),
(2, 'PT. Sukses Sejahtera', 'Jl. Thamrin No. 5, Jakarta', '021-87654321', '', 1, NULL, '2025-09-16 10:15:30', NULL);

-- Insert data untuk tabel role_user
INSERT INTO `role_user` (`id_role`, `nama_role`, `deskripsi`) VALUES
(1, 'Super Admin', 'Mengelola semua perusahaan'),
(2, 'Admin Perusahaan', 'Mengelola seluruh data dan transaksi dalam lingkup perusahaannya'),
(3, 'Sales Online', 'Melakukan input pemindahan barang ke konsumen, tidak menyimpan stok'),
(4, 'Admin Packing', 'Menangani proses packing, pengiriman, dan konfirmasi barang sampai'),
(5, 'Admin Return', 'Memproses verifikasi dan approval retur barang');

-- Insert data untuk tabel menu
INSERT INTO `menu` (`id_menu`, `nama_menu`, `url`, `permission`, `icon`, `deskripsi`, `urutan`, `id_parent`, `status_aktif`, `tipe`) VALUES
(1, 'Dashboard', 'dashboard', NULL, 'fas fa-tachometer-alt', NULL, 1, NULL, 1, 'menu'), 
(2, 'Setup', '#', NULL, 'fas fa-database', NULL, 2, NULL, 1, 'menu'), 
(3, 'Perusahaan', 'setup/perusahaan', NULL, 'fas fa-building', NULL, 1, 2, 1, 'submenu'), 
(4, 'Kategori Barang', 'setup/kategori', NULL, 'fas fa-tags', NULL, 2, 2, 1, 'submenu'), 
(5, 'Barang', 'setup/barang', NULL, 'fas fa-box', NULL, 3, 2, 1, 'submenu'), 
(6, 'Gudang', 'setup/gudang', NULL, 'fas fa-warehouse', NULL, 4, 2, 1, 'submenu'), 
(7, 'Pelanggan', 'setup/pelanggan', NULL, 'fas fa-users', NULL, 5, 2, 1, 'submenu'), 
(8, 'Supplier', 'setup/supplier', NULL, 'fas fa-truck', NULL, 6, 2, 1, 'submenu'), 
(9, 'Sales', 'setup/user/sales', NULL, 'fas fa-user-tag', NULL, 7, 2, 1, 'submenu'), 
(10, 'Admin Packing', 'setup/user/packing', NULL, 'fas fa-user-cog', NULL, 8, 2, 1, 'submenu'), 
(11, 'Aktifitas', '#', NULL, 'fas fa-exchange-alt', NULL, 3, NULL, 1, 'menu'), 
(12, 'Pemindahan Barang', 'aktifitas/pemindahan', NULL, 'fas fa-truck-loading', NULL, 1, 11, 1, 'submenu'), 
(13, 'Penerimaan Barang', 'aktifitas/penerimaan', NULL, 'fas fa-clipboard-check', NULL, 2, 11, 1, 'submenu'), 
(14, 'Retur Penjualan', 'aktifitas/retur_penjualan', NULL, 'fas fa-undo-alt', NULL, 3, 11, 1, 'submenu'), 
(15, 'Retur Pembelian', 'aktifitas/retur_pembelian', NULL, 'fas fa-undo', NULL, 4, 11, 1, 'submenu'), 
(16, 'Daftar', '#', NULL, 'fas fa-list', NULL, 4, NULL, 1, 'menu'), 
(17, 'Pemindahan Barang', 'daftar/pemindahan', NULL, 'fas fa-truck', NULL, 1, 16, 1, 'submenu'), 
(18, 'Penerimaan Barang', 'daftar/penerimaan', NULL, 'fas fa-clipboard-list', NULL, 2, 16, 1, 'submenu'), 
(19, 'Retur Penjualan', 'daftar/retur_penjualan', NULL, 'fas fa-undo-alt', NULL, 3, 16, 1, 'submenu'), 
(20, 'Retur Pembelian', 'daftar/retur_pembelian', NULL, 'fas fa-undo', NULL, 4, 16, 1, 'submenu'), 
(21, 'Laporan', '#', NULL, 'fas fa-chart-bar', NULL, 5, NULL, 1, 'menu'), 
(22, 'Sales', 'laporan/sales', NULL, 'fas fa-chart-line', NULL, 1, 21, 1, 'submenu'), 
(23, 'Packing', 'laporan/packing', NULL, 'fas fa-boxes', NULL, 2, 21, 1, 'submenu'), 
(24, 'Mutasi Barang', 'laporan/mutasi', NULL, 'fas fa-exchange-alt', NULL, 3, 21, 1, 'submenu'), 
(25, 'Ringkasan Stok', 'laporan/summary', NULL, 'fas fa-file-invoice-dollar', NULL, 4, 21, 1, 'submenu'), 
(26, 'Pengaturan', '#', NULL, 'fas fa-cog', NULL, 6, NULL, 1, 'menu'), 
(27, 'Stok Awal', 'pengaturan/stok_awal', NULL, 'fas fa-dolly-flatbed', NULL, 1, 26, 1, 'submenu'), 
(28, 'Hak Akses', 'pengaturan/hak_akses', NULL, 'fas fa-user-shield', NULL, 2, 26, 1, 'submenu'), 
(29, 'Approval Flow', 'pengaturan/approval', NULL, 'fas fa-tasks', NULL, 3, 26, 1, 'submenu'), 
(30, 'Pengaturan Sistem', 'pengaturan/sistem', NULL, 'fas fa-sliders-h', NULL, 4, 26, 1, 'submenu');


-- Data untuk tabel user
INSERT INTO `user` (`id_user`, `nama`, `username`, `password_hash`, `id_role`, `id_perusahaan`, `email`, `telepon`, `created_by`, `aktif`, `created_at`, `updated_at`, `last_login`, `foto_profil`, `remember_token`, `token_expires`) VALUES
(1, 'Super Admin', 'admin', '$2y$10$Jk0IyD8hFSY6CbpX5MJtD.3GlVjw.g9hAVM/rymsjmza2cnTl02aq', 1, NULL, 'admin@example.com', '081234567890', NULL, 1, '2025-09-16 00:13:33', NULL, '2025-09-20 07:03:20', NULL, NULL, NULL),
(2, 'Admin Perusahaan', 'admin_pt', '$2y$10$Jk0IyD8hFSY6CbpX5MJtD.3GlVjw.g9hAVM/rymsjmza2cnTl02aq', 2, 1, 'admin@perusahaan.com', '081234567891', NULL, 1, '2025-09-16 00:13:33', NULL, '2025-09-20 06:53:05', NULL, NULL, NULL),
(3, 'Sales Online', 'sales', '$2y$10$Jk0IyD8hFSY6CbpX5MJtD.3GlVjw.g9hAVM/rymsjmza2cnTl02aq', 3, 1, 'sales@perusahaan.com', '081234567892', NULL, 1, '2025-09-16 00:13:33', NULL, '2025-09-20 04:29:15', NULL, NULL, NULL),
(4, 'Admin Packing', 'packing', '$2y$10$Jk0IyD8hFSY6CbpX5MJtD.3GlVjw.g9hAVM/rymsjmza2cnTl02aq', 4, 1, 'packing@perusahaan.com', '081234567893', NULL, 1, '2025-09-16 00:13:33', NULL, NULL, NULL, NULL, NULL),
(5, 'Admin Return', 'return', '$2y$10$Jk0IyD8hFSY6CbpX5MJtD.3GlVjw.g9hAVM/rymsjmza2cnTl02aq', 5, 1, 'return@perusahaan.com', '081234567894', NULL, 1, '2025-09-16 00:13:33', NULL, NULL, NULL, NULL, NULL);

-- Data untuk tabel kategori
INSERT INTO `kategori` (`id_kategori`, `id_perusahaan`, `nama_kategori`, `deskripsi`, `status_aktif`, `deleted_at`, `created_at`, `updated_at`) VALUES
(1, 1, 'Shock', 'Shockbreaker motor', 1, NULL, '2025-09-18 00:28:37', NULL),
(2, 1, 'Furniture', 'Barang furniture', 1, NULL, '2025-09-18 09:45:12', NULL),
(3, 2, 'Tekstil', 'Barang tekstil', 1, NULL, '2025-09-18 11:20:45', NULL);

-- Data untuk tabel gudang
INSERT INTO `gudang` (`id_gudang`, `id_perusahaan`, `nama_gudang`, `alamat`, `telepon`, `created_by`, `status_aktif`, `deleted_at`, `created_at`, `updated_at`) VALUES
(1, 1, 'Gudang Utama', 'Alamat Gudang Utama', '02112345679', NULL, 1, NULL, '2025-09-16 00:12:08', NULL),
(2, 1, 'Gudang Jakarta Timur', 'Jl. Jatinegara No. 10', '02112345680', 1, 1, NULL, '2025-09-17 19:01:45', '2025-09-20 06:18:46'),
(3, 2, 'Gudang Pusat', 'Jl. Gatot Subroto No. 5', '02187654322', 2, 1, NULL, '2025-09-18 08:30:15', NULL);

-- Data untuk tabel pelanggan
INSERT INTO `pelanggan` (`id_pelanggan`, `id_perusahaan`, `nama_pelanggan`, `alamat`, `telepon`, `email`, `tipe_pelanggan`, `id_sales`, `status_aktif`, `deleted_at`, `created_at`, `updated_at`) VALUES
(1, 1, 'Toko Maju Jaya', 'Jl. Sudirman No. 15', '02112345681', 'toko@maju.com', 'distributor', NULL, 1, NULL, '2025-09-19 10:18:12', '2025-09-19 10:18:24'),
(2, 1, 'Budi Santoso', 'Jl. Thamrin No. 20', '081234567893', 'budi@email.com', 'konsumen', 3, 1, NULL, '2025-09-19 11:30:45', NULL),
(3, 2, 'CV. Sukses Abadi', 'Jl. Gatot Subroto No. 15', '02187654323', 'sukses@abadi.com', 'distributor', NULL, 1, NULL, '2025-09-19 13:45:20', NULL);

-- Data untuk tabel supplier
INSERT INTO `supplier` (`id_supplier`, `id_perusahaan`, `nama_supplier`, `alamat`, `telepon`, `email`, `kontak_person`, `status_aktif`, `deleted_at`, `created_at`, `updated_at`) VALUES
(1, 1, 'PT. Elektronik Indah', 'Jl. Gatot Subroto No. 25', '02112345682', 'info@elektronik.com', 'Budi', 1, NULL, '2025-09-19 10:17:53', '2025-09-19 10:18:02'),
(2, 2, 'PT. Tekstil Makmur', 'Jl. Sudirman No. 30', '02187654324', 'info@tekstil.com', 'Siti', 1, NULL, '2025-09-19 14:20:15', NULL);
-- Data untuk tabel approval_flow
INSERT INTO `approval_flow` (`id_approval`, `tipe_transaksi`, `status_dari`, `status_ke`, `id_role`, `urutan`, `status_aktif`) VALUES
(1, 'pemindahan_barang', 'Draft', 'Packing', 4, 1, 1), (2, 'pemindahan_barang', 'Packing', 'Shipping', 4, 2, 1), (3, 'pemindahan_barang', 'Shipping', 'Delivered', 4, 3, 1), (4, 'pemindahan_barang', 'Draft', 'Cancelled', 4, 4, 1), (5, 'pemindahan_barang', 'Packing', 'Cancelled', 4, 5, 1), (6, 'pemindahan_barang', 'Shipping', 'Cancelled', 4, 6, 1), (7, 'penerimaan_barang', 'Draft', 'Received', 2, 1, 1), (8, 'penerimaan_barang', 'Received', 'Completed', 2, 2, 1), (9, 'penerimaan_barang', 'Draft', 'Cancelled', 2, 3, 1), (10, 'penerimaan_barang', 'Received', 'Cancelled', 2, 4, 1), (11, 'retur_penjualan', 'Requested', 'Verification', 5, 1, 1), (12, 'retur_penjualan', 'Verification', 'Approved', 5, 2, 1), (13, 'retur_penjualan', 'Verification', 'Rejected', 5, 3, 1), (14, 'retur_penjualan', 'Approved', 'Completed', 5, 4, 1), (15, 'retur_pembelian', 'Requested', 'Verification', 5, 1, 1), (16, 'retur_pembelian', 'Verification', 'Approved', 5, 2, 1), (17, 'retur_pembelian', 'Verification', 'Rejected', 5, 3, 1), (18, 'retur_pembelian', 'Approved', 'Completed', 5, 4, 1);

-- Data untuk tabel hak_akses_menu
INSERT INTO `hak_akses_menu` (`id_hak_akses`, `id_role`, `id_menu`, `can_view`, `can_create`, `can_edit`, `can_delete`) VALUES
-- Super Admin (id_role = 1) - Akses penuh ke semua menu
(1, 1, 1, 1, 1, 1, 1), (2, 1, 2, 1, 1, 1, 1), (3, 1, 3, 1, 1, 1, 1), (4, 1, 4, 1, 1, 1, 1), (5, 1, 5, 1, 1, 1, 1), (6, 1, 6, 1, 1, 1, 1), (7, 1, 7, 1, 1, 1, 1), (8, 1, 8, 1, 1, 1, 1), (9, 1, 9, 1, 1, 1, 1), (10, 1, 10, 1, 1, 1, 1), (11, 1, 11, 1, 1, 1, 1), (12, 1, 12, 1, 1, 1, 1), (13, 1, 13, 1, 1, 1, 1), (14, 1, 14, 1, 1, 1, 1), (15, 1, 15, 1, 1, 1, 1), (16, 1, 16, 1, 1, 1, 1), (17, 1, 17, 1, 1, 1, 1), (18, 1, 18, 1, 1, 1, 1), (19, 1, 19, 1, 1, 1, 1), (20, 1, 20, 1, 1, 1, 1), (21, 1, 21, 1, 1, 1, 1), (22, 1, 22, 1, 1, 1, 1), (23, 1, 23, 1, 1, 1, 1), (24, 1, 24, 1, 1, 1, 1), (25, 1, 25, 1, 1, 1, 1), (26, 1, 26, 1, 1, 1, 1), (27, 1, 27, 1, 1, 1, 1), (28, 1, 28, 1, 1, 1, 1), (29, 1, 29, 1, 1, 1, 1), (30, 1, 30, 1, 1, 1, 1),

-- Admin Perusahaan (id_role = 2) - Akses penuh di perusahaannya
(31, 2, 1, 1, 1, 1, 1), (32, 2, 2, 1, 1, 1, 1), (33, 2, 3, 1, 1, 1, 1), (34, 2, 4, 1, 1, 1, 1), (35, 2, 5, 1, 1, 1, 1), (36, 2, 6, 1, 1, 1, 1), (37, 2, 7, 1, 1, 1, 1), (38, 2, 8, 1, 1, 1, 1), (39, 2, 9, 1, 1, 1, 1), (40, 2, 10, 1, 1, 1, 1), (41, 2, 11, 1, 1, 1, 1), (42, 2, 12, 1, 1, 1, 1), (43, 2, 13, 1, 1, 1, 1), (44, 2, 14, 1, 1, 1, 1), (45, 2, 15, 1, 1, 1, 1), (46, 2, 16, 1, 1, 1, 1), (47, 2, 17, 1, 1, 1, 1), (48, 2, 18, 1, 1, 1, 1), (49, 2, 19, 1, 1, 1, 1), (50, 2, 20, 1, 1, 1, 1), (51, 2, 21, 1, 1, 1, 1), (52, 2, 22, 1, 1, 1, 1), (53, 2, 23, 1, 1, 1, 1), (54, 2, 24, 1, 1, 1, 1), (55, 2, 25, 1, 1, 1, 1), (56, 2, 26, 1, 1, 1, 1), (57, 2, 27, 1, 1, 1, 1), (58, 2, 28, 1, 1, 1, 1), (59, 2, 29, 1, 1, 1, 1), (60, 2, 30, 1, 1, 1, 1),

-- Sales Online (id_role = 3) - Hanya bisa melihat dan membuat pemindahan barang ke konsumen miliknya
(61, 3, 1, 1, 0, 0, 0), (62, 3, 2, 1, 0, 0, 0), (63, 3, 4, 1, 0, 0, 0), (64, 3, 5, 1, 0, 0, 0), (65, 3, 6, 1, 0, 0, 0), (66, 3, 7, 1, 0, 0, 0), (67, 3, 11, 1, 1, 1, 0), (68, 3, 12, 1, 1, 1, 0), (69, 3, 16, 1, 1, 1, 0), (70, 3, 17, 1, 1, 1, 0), (71, 3, 21, 1, 1, 0, 0), (72, 3, 22, 1, 1, 0, 0),

-- Admin Packing (id_role = 4) - Bisa mengelola packing dan pengiriman
(73, 4, 1, 1, 0, 0, 0), (74, 4, 11, 1, 0, 0, 0), (75, 4, 12, 1, 1, 1, 0), (76, 4, 16, 1, 1, 1, 0), (77, 4, 17, 1, 1, 1, 0), (78, 4, 21, 1, 1, 0, 0), (79, 4, 23, 1, 1, 0, 0),

-- Admin Return (id_role = 5) - Bisa memproses retur
(80, 5, 1, 1, 0, 0, 0), (81, 5, 11, 1, 0, 0, 0), (82, 5, 13, 1, 0, 0, 0), (83, 5, 14, 1, 1, 1, 0), (84, 5, 15, 1, 1, 1, 0), (85, 5, 16, 1, 0, 0, 0), (86, 5, 19, 1, 1, 1, 0), (87, 5, 20, 1, 1, 1, 0), (88, 5, 21, 1, 1, 0, 0);


-- Insert data toko_konsumen
INSERT INTO `toko_konsumen` (`id_toko_konsumen`, `nama_toko_konsumen`) VALUES
(1, 'Shopee'),
(2, 'TikTok Shop'),
(3, 'Tokopedia'),
(4, 'Lazada'),
(5, 'Blibli'),
(6, 'Facebook Marketplace');



-- Insert data dummy untuk motor
INSERT INTO `motor` (`id_motor`, `nama_motor`, `status_aktif`) VALUES
(1, 'Nouvo', 1),
(2, 'Aerox', 1),
(3, 'Mio', 1),
(4, 'Vario', 1),
(5, 'Nmax', 1),
(6, 'Nmax New', 1),
(7, 'PCX 150', 1),
(8, 'Beat', 1),
(9, 'KLX', 1),
(10, 'Rx King', 1),
(11, 'Nmax Old', 1);

-- Insert data dummy untuk warna
INSERT INTO `warna` (`id_warna`, `nama_warna`, `status_aktif`) VALUES
(1, 'Black', 1),
(2, 'Titanium', 1),
(3, 'Gold', 1),
(4, 'Red', 1),
(5, 'Silver', 1),
(6, 'Chrome', 1),
(7, 'Blue', 1),
(8, 'Green', 1),
(9, 'Blue-Gold (Twotone)', 1),
(10, 'Black/Titanium', 1),
(11, 'Gold/Red', 1),
(12, 'Silver/Chrome', 1),
(13, 'Silver/Red', 1),
(14, 'Black/Red', 1),
(15, 'Black/Titanium Head Gold', 1),
(16, 'Silver/Chrome Head Sliver', 1);

-- Insert data barang dengan struktur baru
INSERT INTO barang 
(id_barang, id_perusahaan, id_kategori, nama_barang, gambar, sku, kode_barang, ukuran, deskripsi, satuan, warna, motor, status_aktif, deleted_at, created_at, updated_at) 
VALUES
(1, 1, 1, 'Shock DBS Premium GP Kitaco', 'gambar.jpg', 'DBS-677-280MM', '677-280MM', '280MM', '', 'set', 'Black/Titanium Head Gold', 'Nouvo,Aerox', 1, NULL, '2025-09-20 02:47:00', '2025-09-21 02:47:00'),
(2, 1, 1, 'Shock DBS Premium King New Series', 'gambar.jpg', 'DBS-612-315MM', '612-315MM', '315MM', '', 'unit', 'Black/Titanium Head Gold', 'Mio/Vario', 1, NULL, '2025-09-21 02:47:00', '2025-09-22 02:47:00'),
(3, 1, 1, 'Shock DBS Premium King New Series', 'gambar.jpg', 'DBS-612-330MM', '612-330MM', '330MM', '', 'unit', 'Black/Titanium Head Gold', 'Mio/Vario', 1, NULL, '2025-09-21 02:47:00', '2025-09-22 02:47:00'),
(4, 1, 1, 'Shock DBS Premium Proline Series', 'gambar.jpg', 'DBS-655-310MM', '655-310MM', '310MM', '', 'set', 'Gold/Red', 'Aerox/Nmax', 1, NULL, '2025-09-22 02:47:00', '2025-09-23 02:47:00'),
(5, 1, 1, 'Shock DBS G-Plus', 'gambar.jpg', 'DBS-8899-310MM', '8899-310MM', '310MM', '', 'unit', 'Silver/Chrome Head Sliver', 'Mio', 1, NULL, '2025-09-23 02:47:00', '2025-09-24 02:47:00'),
(6, 1, 1, 'Shock DBS Tabung Shock Depan', 'gambar.jpg', 'DBS-8905', '8905', '-', '', 'unit', 'Gold/Blue-Gold (Twotone)', 'Beat', 1, NULL, '2025-09-24 02:47:00', '2025-09-25 02:47:00'),
(7, 1, 1, 'Shock DBS Premium Avon Series Tabung Atas', 'gambar.jpg', 'DBS-688-405MM', '688-405MM', '405MM', '', 'unit', 'Gold/Green', 'KLX', 1, NULL, '2025-09-25 02:47:00', '2025-09-26 02:47:00'),
(8, 1, 1, 'Shock DBS X-Series S36PRI', 'gambar.jpg', 'DBS-720-310MM', '720-310MM', '310MM', '', 'set', 'Black/Titanium', 'Aerox/Nmax New', 1, NULL, '2025-09-26 02:47:00', '2025-09-27 02:47:00'),
(9, 1, 1, 'Shock DBS X-Series S36PRI', 'gambar.jpg', 'DBS-699-315MM', '699-315MM', '315MM', '', 'set', 'Black/Titanium', 'Mio/Vario', 1, NULL, '2025-09-26 02:47:00', '2025-09-27 02:47:00'),
(10, 1, 1, 'Shock DBS Von Series', 'gambar.jpg', 'DBS-699-330MM', '699-330MM', '330MM', '', 'set', 'Silver/Red', 'Mio/Vario', 1, NULL, '2025-09-27 02:47:00', '2025-09-28 02:47:00'),
(11, 1, 1, 'Shock DBS Von Series', 'gambar.jpg', 'DBS-719-320MM', '719-320MM', '320MM', '', 'set', 'Silver/Red', 'Rx King', 1, NULL, '2025-09-28 02:47:00', '2025-09-29 02:47:00'),
(12, 1, 1, 'Shock DBS G-Sport', 'gambar.jpg', 'DBS-711-345MM', '711-345MM', '345MM', '', 'set', 'Black/Red', 'Nmax Old/PCX 150', 1, NULL, '2025-09-29 02:47:00', '2025-09-30 02:47:00');

kita akan melengkapi kode kode yg belum sesuai ya bro,
setelah pesan ini, saya akan kirim kode untuk fitur pemindahan barang, agar dapat sesuai dengan yg dibutuhkan serta desain database yg sudah dimiliki.

perlu di ingat bahwa role user ini penting sebab yg menentukan tampilan, terutama super admin yg tidak memiliki perusahaan, jadi jika super admin membutuhkan id_perusahaan maka seharusnya ada pilihan untuk pilih perusahaan nya.

jawab dengan singkat agar tidak gampang kena limit ya.
tunggu hingga saya meminta anda mengecek kode baru anda perbaiki kode dan berikan saran


halaman Stok Awal saat pertama kali dibuka sudah menampilkan list tabel barang mana saja yang sudah memiliki stok,
saya ingin menambahkan untuk fitur ini dapat digunakan oleh super admin dan juga admin perusahaan,
dimana, saat pertama kali dibuka semua barang muncul dengan keterangan- keterangannya,
kode yg sudah dimili yaitu:


<script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>

yang ingin saya tanyakan adalah, dari penjelasan rancangan sistem yang sedang di bangun,
apakah rancangan databse ini sudah sesuai?
sepertinya belum sebab tidak ada transaksi penjualan dalam rancangan kita kali ini. Benar kan?
jadi mari tolong buatkan rancangan databse yg sesuai dengan rancangan sismtem ini ya.

gudang_system/
â”œâ”€â”€ application/
â”‚   â”œâ”€â”€ cache/
â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â”œâ”€â”€ autoload.php
â”‚   â”‚   â”œâ”€â”€ config.php
â”‚   â”‚   â”œâ”€â”€ constants.php
â”‚   â”‚   â”œâ”€â”€ database.php
â”‚   â”‚   â”œâ”€â”€ doctypes.php
â”‚   â”‚   â”œâ”€â”€ foreign_chars.php
â”‚   â”‚   â”œâ”€â”€ hooks.php
â”‚   â”‚   â”œâ”€â”€ index.html
â”‚   â”‚   â”œâ”€â”€ memcached.php
â”‚   â”‚   â”œâ”€â”€ migration.php
â”‚   â”‚   â”œâ”€â”€ mimes.php
â”‚   â”‚   â”œâ”€â”€ profiler.php
â”‚   â”‚   â”œâ”€â”€ routes.php
â”‚   â”‚   â”œâ”€â”€ smileys.php
â”‚   â”‚   â””â”€â”€ user_agents.php
â”‚   â”œâ”€â”€ controllers/
â”‚   â”‚   â”œâ”€â”€ Auth.php
â”‚   â”‚   â”œâ”€â”€ Dashboard.php
â”‚   â”‚   â”œâ”€â”€ Setup/
â”‚   â”‚   â”‚   â”œâ”€â”€ Perusahaan.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Kategori.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Barang.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Gudang.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Pelanggan.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Supplier.php
â”‚   â”‚   â”‚   â””â”€â”€ User.php
â”‚   â”‚   â”œâ”€â”€ Aktifitas/
â”‚   â”‚   â”‚   â”œâ”€â”€ Pemindahan.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Penerimaan.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Retur_penjualan.php
â”‚   â”‚   â”‚   â””â”€â”€ Retur_pembelian.php
â”‚   â”‚   â”œâ”€â”€ Daftar/
â”‚   â”‚   â”‚   â”œâ”€â”€ Pemindahan.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Penerimaan.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Retur_penjualan.php
â”‚   â”‚   â”‚   â””â”€â”€ Retur_pembelian.php
â”‚   â”‚   â”œâ”€â”€ Laporan/
â”‚   â”‚   â”‚   â”œâ”€â”€ Sales.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Packing.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Mutasi.php
â”‚   â”‚   â”‚   â””â”€â”€ Summary.php
â”‚   â”‚   â”œâ”€â”€ Pengaturan/
â”‚   â”‚   â”‚   â”œâ”€â”€ Stok_awal.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Hak_akses.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Approval.php
â”‚   â”‚   â”‚   â””â”€â”€ Sistem.php
â”‚   â”‚   â””â”€â”€ index.html
â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”œâ”€â”€ MY_Controller.php
â”‚   â”‚   â”œâ”€â”€ MY_Model.php
â”‚   â”‚   â””â”€â”€ index.html
â”‚   â”œâ”€â”€ helpers/
â”‚   â”‚   â”œâ”€â”€ company_filter_helper.php
â”‚   â”‚   â”œâ”€â”€ menu_helper.php
â”‚   â”‚   â”œâ”€â”€ stok_helper.php
â”‚   â”‚   â”œâ”€â”€ index.html
â”‚   â”‚   â””â”€â”€ app_helper.php
â”‚   â”œâ”€â”€ libraries/
â”‚   â”‚   â”œâ”€â”€ Auth.php
â”‚   â”‚   â”œâ”€â”€ Menu.php
â”‚   â”‚   â”œâ”€â”€ Stok.php
â”‚   â”‚   â””â”€â”€ index.html
â”‚   â”œâ”€â”€ logs/
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”œâ”€â”€ Auth_model.php
â”‚   â”‚   â”œâ”€â”€ Detail_pembelian_model.php
â”‚   â”‚   â”œâ”€â”€ Detail_penjualan_model.php
â”‚   â”‚   â”œâ”€â”€ Log_status_transaksi_model.php
â”‚   â”‚   â”œâ”€â”€ Log_stok_model.php
â”‚   â”‚   â”œâ”€â”€ Menu_model.php
â”‚   â”‚   â”œâ”€â”€ Pembelian_model.php
â”‚   â”‚   â”œâ”€â”€ Penjualan_model.php
â”‚   â”‚   â”œâ”€â”€ Stok_gudang_model.php
â”‚   â”‚   â”œâ”€â”€ Stok_model.php
â”‚   â”‚   â”œâ”€â”€ Setup/
â”‚   â”‚   â”‚   â”œâ”€â”€ Barang_model.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Gudang_model.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Kategori_model.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Pelanggan_model.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Perusahaan_model.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Stok_gudang_model.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Supplier_model.php
â”‚   â”‚   â”‚   â””â”€â”€ User_model.php
â”‚   â”‚   â”œâ”€â”€ Aktifitas/
â”‚   â”‚   â”‚   â”œâ”€â”€ Pemindahan_model.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Penerimaan_model.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Retur_penjualan_model.php
â”‚   â”‚   â”‚   â””â”€â”€ Retur_pembelian_model.php
â”‚   â”‚   â”œâ”€â”€ Daftar/
â”‚   â”‚   â”‚   â”œâ”€â”€ Pemindahan_model.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Penerimaan_model.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Retur_penjualan_model.php
â”‚   â”‚   â”‚   â””â”€â”€ Retur_pembelian_model.php
â”‚   â”‚   â”œâ”€â”€ Laporan/
â”‚   â”‚   â”‚   â”œâ”€â”€ Sales_model.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Packing_model.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Mutasi_model.php
â”‚   â”‚   â”‚   â””â”€â”€ Summary_model.php
â”‚   â”‚   â”œâ”€â”€ Pengaturan/
â”‚   â”‚   â”‚   â”œâ”€â”€ Stok_awal_model.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Hak_akses_model.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Approval_model.php
â”‚   â”‚   â”‚   â””â”€â”€ Sistem_model.php
â”‚   â”‚   â””â”€â”€ index.html
â”œâ”€â”€ views/application/views/
    â”œâ”€â”€ auth/
    â”‚   â”œâ”€â”€ login.php
    â”œâ”€â”€ errors/
    â”‚   â”œâ”€â”€ error_general.php
    â”‚   â””â”€â”€ error_404.php
    â”œâ”€â”€ layout/
    â”‚   â”œâ”€â”€ header.php
    â”‚   â”œâ”€â”€ top_menu.php
    â”‚   â”œâ”€â”€ footer.php
    â”‚   â”œâ”€â”€ js.php
    â”‚   â””â”€â”€ modal.php
    â”‚   â””â”€â”€ woding.php
    â”œâ”€â”€ dashboard/
    â”‚   â””â”€â”€ index.php
    â”œâ”€â”€ setup/
    â”‚   â”œâ”€â”€ kategori/
    â”‚   â”‚   â”œâ”€â”€ index.php      
    â”‚   â”‚   â”œâ”€â”€ form.php       
    â”‚   â”‚   â””â”€â”€ detail.php     
    â”‚   â”œâ”€â”€ barang/
    â”‚   â”‚   â”œâ”€â”€ index.php      
    â”‚   â”‚   â”œâ”€â”€ form.php       
    â”‚   â”‚   â”œâ”€â”€ detail.php     
    â”‚   â”‚   â””â”€â”€ stok.php       
    â”‚   â”œâ”€â”€ gudang/
    â”‚   â”‚   â”œâ”€â”€ index.php      
    â”‚   â”‚   â”œâ”€â”€ form.php       
    â”‚   â”‚   â””â”€â”€ detail.php     
    â”‚   â”œâ”€â”€ pelanggan/
    â”‚   â”‚   â”œâ”€â”€ index.php      
    â”‚   â”‚   â”œâ”€â”€ form.php       
    â”‚   â”‚   â””â”€â”€ detail.php      
    â”‚   â”œâ”€â”€ perusahaan/
    â”‚   â”‚   â”œâ”€â”€ index.php      
    â”‚   â”‚   â”œâ”€â”€ form.php       
    â”‚   â”‚   â””â”€â”€ detail.php     
    â”‚   â”œâ”€â”€ supplier/
    â”‚   â”‚   â”œâ”€â”€ index.php      
    â”‚   â”‚   â”œâ”€â”€ form.php       
    â”‚   â”‚   â””â”€â”€ detail.php     
    â”‚   â””â”€â”€ user/
    â”‚       â”œâ”€â”€ index.php      
    â”‚       â”œâ”€â”€ form.php       
    â”‚       â”œâ”€â”€ profile.php    
    â”‚       â””â”€â”€ change_password.php
    â”‚       â””â”€â”€ reset_password.php
    â”‚       â””â”€â”€ detail.php
    â”‚       â””â”€â”€ form_edit.php
    â”‚       â””â”€â”€ form_packing.php
    â”‚       â””â”€â”€ form_sales.php
    â”‚       â””â”€â”€ packing.php
    â”‚       â””â”€â”€ sales.php
    â”œâ”€â”€ aktifitas/
    â”‚   â”œâ”€â”€ pemindahan/
    â”‚   â”‚   â”œâ”€â”€ index.php      
    â”‚   â”‚   â”œâ”€â”€ form.php       
    â”‚   â”‚   â”œâ”€â”€ detail.php     
    â”‚   â”œâ”€â”€ penerimaan/
    â”‚   â”‚   â”œâ”€â”€ index.php      
    â”‚   â”‚   â”œâ”€â”€ form.php       
    â”‚   â”‚   â”œâ”€â”€ detail.php     
    â”‚   â”œâ”€â”€ retur_penjualan/
    â”‚   â”‚   â”œâ”€â”€ index.php      
    â”‚   â”‚   â”œâ”€â”€ form.php
    â”‚   â”‚   â”œâ”€â”€ detail.php     
    â”‚   â”‚   â””â”€â”€ verifikasi.php 
    â”‚   â””â”€â”€ retur_pembelian/
    â”‚       â”œâ”€â”€ index.php      
    â”‚       â”œâ”€â”€ form.php
    â”‚       â”œâ”€â”€ detail.php     
    â”‚       â””â”€â”€ verifikasi.php 
    â”œâ”€â”€ daftar/
    â”‚   â”œâ”€â”€ pemindahan/
    â”‚   â”‚   â”œâ”€â”€ cetak.php      
    â”‚   â”‚   â”œâ”€â”€ index.php      
    â”‚   â”‚   â””â”€â”€ detail.php     
    â”‚   â”œâ”€â”€ penerimaan/
    â”‚   â”‚   â”œâ”€â”€ cetak.php      
    â”‚   â”‚   â”œâ”€â”€ index.php      
    â”‚   â”‚   â””â”€â”€ detail.php     
    â”‚   â”œâ”€â”€ retur_penjualan/
    â”‚   â”‚   â”œâ”€â”€ cetak.php      
    â”‚   â”‚   â”œâ”€â”€ index.php      
    â”‚   â”‚   â””â”€â”€ detail.php    
    â”‚   â””â”€â”€ retur_pembelian/
    â”‚   â”‚   â”œâ”€â”€ cetak.php      
    â”‚   â”‚   â”œâ”€â”€ index.php      
    â”‚   â”‚   â””â”€â”€ detail.php    
    â”œâ”€â”€ laporan/
    â”‚   â”œâ”€â”€ sales/
    â”‚   â”‚   â”œâ”€â”€ index.php      
    â”‚   â”‚   â”œâ”€â”€ filter.php     
    â”‚   â”œâ”€â”€ packing/
    â”‚   â”‚   â”œâ”€â”€ index.php      
    â”‚   â”‚   â”œâ”€â”€ detail.php     
    â”‚   â”œâ”€â”€ mutasi/
    â”‚   â”‚   â”œâ”€â”€ index.php      
    â”‚   â””â”€â”€ summary/
    â”‚       â”œâ”€â”€ index.php      
    â”œâ”€â”€ pengaturan/
    â”‚   â”œâ”€â”€ stok_awal/
    â”‚   â”‚   â”œâ”€â”€ index.php      
    â”‚   â”‚   â”œâ”€â”€ form.php       
    â”‚   â”‚   â””â”€â”€ import.php     
    â”‚   â”œâ”€â”€ hak_akses/
    â”‚   â”‚   â”œâ”€â”€ index.php      
    â”‚   â”‚   â”œâ”€â”€ form_role.php       
    â”‚   â”‚   â””â”€â”€ role.php       
    â”‚   â”œâ”€â”€ approval/
    â”‚   â”‚   â”œâ”€â”€ index.php      
    â”‚   â”‚   â”œâ”€â”€ form.php       
    â”‚   â”‚   â””â”€â”€ diagram.php    
    â”‚   â””â”€â”€ sistem/
    â”‚       â”œâ”€â”€ index.php      
    â”‚       â”œâ”€â”€ backup.php     
    â”‚       â””â”€â”€ log.php   
    â”‚       â””â”€â”€ view_log.php   
â”œâ”€â”€ assets/
â”‚   â”œâ”€â”€ css/
â”‚   â”œâ”€â”€ js/
â”‚   â”œâ”€â”€ images/
â”‚   â””â”€â”€ plugins/
â”œâ”€â”€ system/
â”œâ”€â”€ uploads/
â”‚   â”œâ”€â”€ images/
â”‚   â”œâ”€â”€ documents/
â”‚   â””â”€â”€ temp/
â”‚   â””â”€â”€ user/
â”‚   â””â”€â”€ barang/
â”œâ”€â”€ index.php
â”œâ”€â”€ license.txt
â”œâ”€â”€ README.md
â””â”€â”€ .htaccess

Tahapan Pembangunan Sistem Manajemen Stok Gudang (per modul)
1. Pondasi Sistem
Autentikasi:
Modul login & logout
Session management
Middleware role & hak akses menu
Template:
Integrasi SB Admin 2 (header, sidebar, footer, dashboard dummy)
Dinamisasi sidebar dari tabel menu + hak_akses_menu

2. Modul Setup (Master Data)
2.1 Perusahaan & Gudang
Form input/edit perusahaan
Form input/edit gudang (relasi ke perusahaan)
List perusahaan & gudang

2.2 Kategori & Barang
Form kategori barang
Form barang (relasi ke kategori & perusahaan)
Stok awal barang per gudang (stok_awal â†’ update ke stok_gudang)

2.3 User & Role
CRUD user
Mapping role ke menu (Super Admin, Admin Perusahaan, Sales, Packing, Return)

2.4 Supplier & Pelanggan
CRUD supplier
CRUD pelanggan (perusahaan â†’ pelanggan distributor)
âœ… Setelah modul ini jadi â†’ sistem sudah siap punya master data lengkap.

3. Modul Transaksi Utama
3.1 Pembelian
Header pembelian + detail barang
Status: Draft â†’ Menunggu Penerimaan
Belum update stok (stok bertambah di penerimaan)

3.2 Penerimaan Barang
Header penerimaan_barang + detail
Relasi ke pembelian
Status: Draft â†’ Received â†’ Completed
Saat Received â†’ update stok_gudang & log_stok

3.3 Penjualan
Header penjualan + detail barang
Status: Draft â†’ Packing â†’ Shipping â†’ Delivered â†’ Completed
Saat Shipping â†’ stok gudang berkurang + log stok
Integrasi dengan role Sales (user hanya bisa input penjualan, stok tetap dari gudang)

3.4 Transfer Stok
Header transfer_stok + detail barang
Status: Draft â†’ Packing â†’ Shipping â†’ Delivered
Saat Shipping â†’ kurangi stok gudang asal
Saat Delivered â†’ tambah stok gudang tujuan
Catat ke log_stok

3.5 Retur
Retur Penjualan (retur_penjualan + detail)
Requested â†’ Verification â†’ Approved â†’ Completed
Approved â†’ tambah stok ke gudang
Retur Pembelian (retur_pembelian + detail)
Requested â†’ Verification â†’ Approved â†’ Completed
Approved â†’ kurangi stok dari gudang
âœ… Setelah semua transaksi ini beres â†’ sistem sudah bisa jalan penuh dari input barang â†’ pembelian â†’ stok masuk â†’ penjualan â†’ stok keluar â†’ retur.

4. Audit & Approval
Implementasi log_status_transaksi untuk semua transaksi
Catat siapa user yang update status & kapan
Approval flow per role:
Admin Return â†’ approve/reject retur
Admin Packing â†’ approve status packing & shipping
Admin Perusahaan â†’ kontrol penuh transaksi perusahaannya
Super Admin â†’ bisa lihat semua

5. Modul Laporan
5.1 Laporan Sales
Detail penjualan per pelanggan/konsumen
Filter per tanggal, perusahaan, gudang

5.2 Laporan Packing
Daftar aktivitas packing & pengiriman

5.3 Laporan Mutasi
Mutasi barang per gudang
Data dari log_stok

5.4 Laporan Summary
Ringkasan stok per barang & per gudang:
Saldo awal
Masuk
Keluar
Saldo akhi

Pemindahan Barang terbagi menjadi 3
    1. Gudang â†’ Gudang lain (ke gudang di perusahaan yg sama).
    2. Gudang â†’ Pelanggan (distributor resmi).
    3. Gudang â†’ Konsumen (melalui pemindahan barang ke konsumen milik Sales).

jadi,
jika memilih Tipe Tujuan Gudang
berarti harus ada form Gudang awal dan Gudang Tujuan gudang awal 

jika memilih Tipe Tujuan Pelanggan
berarti harus ada form Pemilihan Pelanggan yang di ambil dari tabel pelanggan

dan jika memilih Tipe Tujua
berarti harus ada form Input data konsume
yg berisi Nama dan Alamat



masih belum jalan, kita skip dahulu deh yaaa,
Masih di halaman tambah pemindahan, namun lanjut kita kasih validasi saja terlebih dahulu.
-jika memilih Tipe Tujuan Gudang
berarti harus ada form Gudang awal dan Gudang Tujuan gudang awal tidak boleh sama dengan gudang tujuan

-jika memilih Tipe Tujuan Pelanggan
berarti harus ada form Pemilihan Pelanggan yang di ambil dari tabel pelanggan

-jika memilih Tipe Tujuan Konsumen
berarti harus ada form Input data konsume
yg berisi Nama dan Alamat Konsumen dan TOKO

selanjutanya untuk barang yg belum ada stok awal dan stok nya 0 tidak boleh tampil di input item barang pada halaman ini ya bro


mengapa data konsumen ini disimpan di tabel pemindahan_barang?
bisakah kita buat ke tabel terpisah misalkan kita buat tabel seperti ini,
isi dari nama_toko_konsumen nya ini berupa pilihan dropdown dari tabel toko_konsumen (menghindari input manual)

tabel toko_konsumen
id_toko_konsumen
nama_toko_konsumen varchar(50) DEFAULT NULL
secara default kita beri value
1. Shopee
2. TikTok Shop
3. Tokopedia
4. Lazada
5. Blibli
6. Facebook Marketplace


tabel konsumen
id_konsumen
nama_konsumen varchar(100) DEFAULT NULL
id_toko_konsumen varchar(100) DEFAULT NULL
alamat_konsumen text DEFAULT NULL

lalu selanjutnya baru kode kode nya yg disesuaikan.
bagaimana?





seteleh menerapkan semua saran dari anda, nampaknya ada beberapa yg perlu di perbaiki kembali, yaitu,
1. form tambah pemindahan barang -> seharusnya tidak perlu ada pilih aksi, langsung saja untuk menambahkan konsumen baru dan langsung catat ke tabel konsumen baru untuk dan selanjutnya baru masuk ke tabel pemindahan jika proses nya hingga terjadi pemindaha
2. form tambah pemindahan barang -> Daftar Barang -> jika mau mau melakukan pemindahan 2 buah barang atau lebih (ada 2 barang yg ingin di lakukan pemindahan), stok barang yg tersedia tidak dimuat dengan baik, sehingga proses tidak dapat dilanjutkan
3. form tambah pemindahan barang -> Daftar Barang -> seharunya untuk barang yg sudah di pilih, tidak dapat dipilih kembali dalam proses pemindahan barang yg sama
4. untuk super admin, form tambah pemindahan barang -> pilih perusahaan terkadang suka muncul forbide 403 di url http://localhost/gudang_system/aktifitas/pemindahan/get_data_by_perusahaan

sekarang kita perbaiki ini dahulu yah.



cara yang terakhir ini sudah saya terapkan bro namun sepertinya bug lama masih terjadi dan belum solved, bahkan saya memikirkan perbaikan dan tambahan poin baru lagi, yaitu:
1. form tambah pemindahan barang -> Daftar Barang -> jika mau mau melakukan pemindahan 2 buah barang atau lebih (ada 2 barang yg ingin di lakukan pemindahan), stok barang yg tersedia tidak dimuat dengan baik, sehingga proses tidak dapat dilanjutkan
2. form tambah pemindahan barang -> Daftar Barang -> seharunya untuk barang yg sudah di pilih, tidak dapat dipilih kembali dalam proses pemindahan barang yg sama ini sudah jalan, hanya saja stok masih belum berhasil di dapat dan di tampilkan
3. khusus untuk super admin, form tambah pemindahan barang -> pilih perusahaan terkadang suka muncul forbide 403 di url http://localhost/gudang_system/aktifitas/pemindahan/get_data_by_perusahaan saya curiga ini membutuhkan token kembali ketika pilih ulang atau ganti ganti perusahaan
4. label lokasi tujuan sebaiknya kita hilangkan saja, agar tampilan lebih OK
5. Tipe tujuan bisa tidak kita buat default langsung menuju Konsumen, dan langsung menampilkan form tambahan yg sudah di diskusikan, jadi tidak perlu lagi ada text "Pilih Tipe" namun langsung saja Konsumen, Pelanggan, Gudang.
6. form tambah pemindahan barang -> Daftar Barang -> Sepertinya bagian form ini (Nama Konsumen / Toko / Alamat Konsumen) perlu di tataulang, baik dari sisi responsive dan urutannya


jadi saat ini ada 6 poin yg perlu dibantu untuk perbaikan.
beri kode untuk solved issue ini dan bantu saya